<div class="container">
    <div class="row mb-5">
        <div class="col-md-12">
            <div class="card card-flush">
                <div class="card-header align-items-center py-5 gap-2 gap-md-5">
                    <!-- FILTERS -->
                    <div class="card-body">
                        <div class="row">
                            <div class="col"></div>
                            <div class="col-3 text-end">
                                <button class="btn btn-dark" (click)="goBack()">
                                    {{"BACK" | translate}}
                                </button>
                            </div>
                        </div>


                        <!-- HIDE FILTERS DURING CLOSING DAY STATE AND SHOW ONLY TEXT -->
                        <ng-container *ngIf="!iStatisticId">

                            <div class="row mb-5">
                                <div class="col-md-6">
                                    <!-- For Dynamic, Start Date and End Date -->
                                    <div class="row mb-5" *ngIf="IsDynamicState">
                                        <!-- START_DATE -->
                                        <div class="col-md-6">
                                            <label class="fs-6 form-label fw-bolder text-dark">{{'START_DATE' |
                                                translate}}</label>
                                            <input type="datetime-local"
                                                class="form-control form-control form-control-solid" name="startDate"
                                                [ngModel]="filterDates.startDate"
                                                (ngModelChange)="filterDates.startDate = $event;" />
                                        </div>
                                        <!-- END_DATE -->
                                        <div class="col-md-6">
                                            <label class="fs-6 form-label fw-bolder text-dark">{{'END_DATE' |
                                                translate}}</label>
                                            <input type="datetime-local" class="form-control form-control-solid"
                                                name="endDate" [ngModel]="filterDates.endDate"
                                                (ngModelChange)="filterDates.endDate = $event;" />
                                        </div>
                                    </div>

                                    <!-- For Static, FROM-STATE to TO-STATE -->
                                    <div class="row mb-5" *ngIf="!IsDynamicState">

                                        <div class="col-md-6">
                                            <label class="fs-6 form-label fw-bolder text-dark">{{'FROM_STATE' |
                                                translate}}</label>
                                            <ng-select class="form-control form-control-solid p-0"
                                                [(ngModel)]="statisticFilter.dFromState" [clearable]="false"
                                                (change)="onStateChange($event, true, aDayClosure)">
                                                <ng-option *ngFor="let oDayClosure of aDayClosure"
                                                    [value]="oDayClosure.dOpenDate">
                                                    {{oDayClosure?.dOpenDate | date: 'yyyy-MM-dd HH:mm'}} |
                                                    {{oDayClosure?.sWorkStationName}}
                                                </ng-option>
                                            </ng-select>
                                        </div>

                                        <div class="col-md-6">
                                            <label class="fs-6 form-label fw-bolder text-dark">{{'TO_STATE' |
                                                translate}}</label>
                                            <ng-select class="form-control form-control-solid p-0"
                                                [(ngModel)]="statisticFilter.dToState" [clearable]="false"
                                                (change)="onStateChange($event, false, aDayClosure)">
                                                <ng-option *ngFor="let oDayClosure of aDayClosure"
                                                    [value]="oDayClosure.dCloseDate"
                                                    [disabled]="oDayClosure?.isDisable ? true : false">
                                                    {{oDayClosure?.dCloseDate | date: 'yyyy-MM-dd HH:mm' }} |
                                                    {{oDayClosure?.sWorkStationName}}
                                                </ng-option>
                                            </ng-select>
                                        </div>

                                    </div>

                                </div>

                                <!-- VIEW -->
                                <div class="col-md-3 show menu-dropdown">
                                    <label class="fs-6 form-label fw-bolder text-dark">{{'VIEW' | translate}}</label>
                                    <!--begin::Menu-->
                                    <div class="menu menu-rounded menu-column menu-gray-600 menu-state-bg fw-semibold form-control form-control-solid"
                                        data-kt-menu="true">
                                        <!--begin::Menu item-->
                                        <div class="menu-item" data-kt-menu-trigger="hover" data-kt-menu-attach="parent"
                                            data-kt-menu-placement="bottom-start">
                                            <!--begin::Menu link-->
                                            <a class="menu-link py-3">
                                                <span class="menu-title text-overflow-ellipsis">{{sSelectedOptionMenu
                                                    ||'Select'}}</span>
                                                <span class="menu-arrow"></span>
                                            </a>
                                            <!--end::Menu link-->

                                            <!--begin::Menu sub-->
                                            <div class="menu-sub menu-sub-dropdown p-3 w-200px">
                                                <!--begin::Menu item-->
                                                <div class="menu-item" *ngFor="let parent of aOptionMenu">
                                                    <div class="menu-item" data-kt-menu-trigger="hover"
                                                        data-kt-menu-placement="right-start">
                                                        <!--begin::Menu link-->
                                                        <a class="menu-link py-3">
                                                            <span class="menu-icon">
                                                                <i class="bi bi-bar-chart fs-3"></i>
                                                            </span>
                                                            <span class="menu-title">{{parent.sKey | translate}}</span>
                                                            <span class="menu-arrow"></span>
                                                        </a>
                                                        <!--end::Menu link-->

                                                        <!--begin::Menu sub-->
                                                        <div class="menu-sub menu-sub-dropdown p-3 w-200px">
                                                            <!--begin::Menu item-->
                                                            <div class="menu-item">
                                                                <div class="menu-item">
                                                                    <div *ngFor="let child1 of parent.children"
                                                                        class="menu-item" data-kt-menu-trigger="hover"
                                                                        data-kt-menu-placement="right-start">
                                                                        <!--begin::Menu link-->
                                                                        <a class="menu-link py-3">
                                                                            <span class="menu-icon">
                                                                                <i class="bi bi-bar-chart fs-3"></i>
                                                                            </span>
                                                                            <span
                                                                                class="menu-title">{{child1.sValue}}</span>
                                                                            <span class="menu-arrow"></span>
                                                                        </a>
                                                                        <!--end::Menu link-->

                                                                        <!--begin::Menu sub-->
                                                                        <div
                                                                            class="menu-sub menu-sub-dropdown p-3 w-200px">
                                                                            <!--begin::Menu item-->
                                                                            <div *ngFor="let child2 of child1.children"
                                                                                class="menu-item">
                                                                                <a (click)="onDropdownItemSelected(parent,child1,child2)"
                                                                                    class="menu-link px-1 py-3">
                                                                                    <span class="menu-bullet me-0">
                                                                                        <span
                                                                                            class="bullet bullet-dot"></span>
                                                                                    </span>
                                                                                    <span
                                                                                        class="menu-title">{{child2.sValue}}</span>
                                                                                </a>
                                                                            </div>
                                                                            <!--end::Menu item-->

                                                                        </div>
                                                                        <!--end::Menu sub-->
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <!--end::Menu item-->


                                                        </div>
                                                        <!--end::Menu sub-->
                                                    </div>
                                                </div>
                                                <!--end::Menu item-->


                                            </div>
                                            <!--end::Menu sub-->
                                        </div>
                                        <!--end::Menu item-->

                                    </div>
                                    <!--end::Menu-->

                                </div>

                                <!-- LOCATION -->
                                <div class="col-md-3">
                                    <label class="fs-6 form-label fw-bolder text-dark">{{'LOCATION' |
                                        translate}}</label>
                                    <div class="w-100" *ngIf="aLocation?.length">
                                        <ng-select [multiple]="true" [items]="aLocation" [(ngModel)]="aSelectedLocation"
                                            name="iLocationId" bindValue="_id" bindLabel="sName" placeholder="Select"
                                            required [closeOnSelect]="false" (change)="fetchAuditStatistic()">

                                            <ng-template ng-option-tmp let-item="item" let-item$="item$"
                                                let-index="index">
                                                <input id="item-{{index}}" type="checkbox" name="item-{{index}}"
                                                    [ngModel]="item$.selected" />
                                                {{item.sName}}
                                            </ng-template>

                                        </ng-select>

                                    </div>
                                </div>
                            </div>

                            <div class="row mb-5">
                                <!-- EMPLOYEE -->
                                <div class="col-md-6">
                                    <div class="row mb-5">
                                        <div class="col-md-6">
                                            <label class="fs-6 form-label fw-bolder text-dark">{{'EMPLOYEE' |
                                                translate}}</label>
                                            <ng-select class="form-control form-control-solid p-0"
                                                [(ngModel)]="selectedEmployee" (ngModelChange)="checkShowDownload()"
                                                [clearable]="false">
                                                <ng-option *ngFor="let oEmployee of aEmployee" [value]="oEmployee">
                                                    {{oEmployee.sFirstName + ' ' +oEmployee.sLastName}}
                                                </ng-option>
                                            </ng-select>
                                        </div>
                                        <!-- WORK_STATION -->
                                        <div class="col-md-6">
                                            <label class="fs-6 form-label fw-bolder text-dark">{{'WORK_STATION' |
                                                translate}}</label>

                                            <ng-select [multiple]="true" [items]="aWorkStation"
                                                [(ngModel)]="selectedWorkStation" name="selectedWorkStation"
                                                bindValue="_id" bindLabel="sName" placeholder="Select" required
                                                [closeOnSelect]="false" (change)="fetchAuditStatistic()">

                                                <ng-template ng-option-tmp let-item="item" let-item$="item$"
                                                    let-index="index">
                                                    <input id="item-{{index}}" type="checkbox" name="item-{{index}}"
                                                        [ngModel]="item$.selected" />
                                                    {{item.sName}}
                                                </ng-template>

                                            </ng-select>

                                        </div>
                                    </div>
                                </div>

                                <ng-container>
                                    <!-- PROPERTIES -->
                                    <div class="col-md-6" *ngIf="bShowProperty">
                                        <label class="fs-6 form-label fw-bolder text-dark">{{ "PROPERTIES" |
                                            translate}}</label>
                                        <div class="overflow-scroll py-1 h-200px">

                                            <div *ngFor="let property of aProperty; let pIndex = index">
                                                <div class="row align-items-center">
                                                    <div class="col-md-4">
                                                        <div>{{property?.sPropertyName | translate}}</div>
                                                    </div>
                                                    <div class="col-md-8">
                                                        <div *ngIf="propertyOptions[property.iPropertyId]?.length">
                                                            <ng-select class="w-100" [multiple]="true"
                                                                [items]="propertyOptions[property.iPropertyId]"
                                                                [(ngModel)]="selectedProperties[property.iPropertyId]"
                                                                name="propertyId" bindValue="sName" bindLabel="sName"
                                                                placeholder="Select"
                                                                (click)="onProperties(property.iPropertyId)" required
                                                                [closeOnSelect]="false">

                                                                <ng-template ng-option-tmp let-item="item"
                                                                    let-item$="item$" let-index="index">
                                                                    <input id="item-{{index}}" type="checkbox"
                                                                        name="item-{{index}}"
                                                                        [ngModel]="item$.selected" />
                                                                    {{item.sName}}
                                                                </ng-template>

                                                            </ng-select>

                                                        </div>
                                                    </div>
                                                </div>
                                                <br>
                                            </div>
                                        </div>
                                    </div>
                                </ng-container>
                            </div>

                            <div class="row mb-5">
                                <ng-container
                                    *ngIf="sDisplayMethod === this.edisplayMethodKeysEnum.revenuePerBusinessPartner || sDisplayMethod === this.edisplayMethodKeysEnum.revenuePerArticleGroupAndProperty ">
                                    <!-- LEVEL_FILTER -->
                                    <div class="col-md-3">
                                        <label class="fs-6 form-label fw-bolder text-dark">{{ "LEVEL_FILTER" |
                                            translate}}</label>
                                        <div class="d-flex mt-2">
                                            <label class="w-75 align-middle lh-xxl" *ngIf="bIsArticleGroupLevel">{{
                                                "ARTICLE_GROUP_LEVEL" |
                                                translate}}</label>
                                            <label class="w-75 align-middle lh-xxl" *ngIf="!bIsArticleGroupLevel">{{
                                                "PRODUCT_LEVEL" |
                                                translate}}</label>
                                            <label
                                                class="form-check form-switch form-check-custom form-check-solid w-25">
                                                <input type="checkbox" class="form-check-input"
                                                    [(ngModel)]="bIsArticleGroupLevel">
                                            </label>
                                        </div>
                                    </div>
                                    <!-- MODE_FILTER -->
                                    <div class="col-md-3">
                                        <label class="fs-6 form-label fw-bolder text-dark">{{ "MODE_FILTER" |
                                            translate}}</label>
                                        <div class="d-flex mt-2">
                                            <label class="w-75 align-middle lh-xxl" *ngIf="bIsSupplierMode">{{
                                                "SUPPLIER_MODE" |
                                                translate}}</label>
                                            <label class="w-75 align-middle lh-xxl" *ngIf="!bIsSupplierMode">{{
                                                "BUSINESS_MODE"
                                                |
                                                translate}}</label>
                                            <label
                                                class="form-check form-switch form-check-custom form-check-solid w-25">
                                                <input type="checkbox" class="form-check-input"
                                                    [(ngModel)]="bIsSupplierMode">
                                            </label>
                                        </div>
                                    </div>
                                </ng-container>

                                <!-- SHOW_DYNAMIC_STATE -->
                                <div class="col-md-3">
                                    <label class="fs-6 form-label fw-bolder text-dark">{{'SHOW_DYNAMIC_STATE' |
                                        translate}}</label>
                                    <br>
                                    <label
                                        class="form-check form-check-sm form-check-custom form-check-solid me-5 me-lg-20">
                                        <input class="form-check-input" type="checkbox" [(ngModel)]="IsDynamicState"
                                            name="IsDynamicState" [disabled]="iStatisticId ? true : false"
                                            (click)="IsDynamicState = !IsDynamicState; fetchAuditStatistic()" />
                                        <span class="form-check-label"> {{ "SHOW_DYNAMIC" | translate}} </span>
                                    </label>
                                </div>
                                <div class="row">
                                    <div class="col-md-3 mt-5">
                                        <button type="button" class="btn btn-primary"
                                            data-kt-roles-modal-action="submit" (click)="fetchAuditStatistic()"
                                            [class.disabled]="bStatisticLoading">
                                            <span class="indicator-label">{{ "APPLY_FILTER" | translate}}</span>
                                        </button>
                                    </div>

                                    <div class="col-md-3 mt-5">
                                        <div *ngIf="closingDayState" class="spinner-border mx-auto"></div>
                                    </div>
                                </div>
                            </div>
                        </ng-container>

                        <ng-container *ngIf="iStatisticId">
                            <div class="row m-0 p-0">

                                <div class="col-6 m-0 p-0">
                                    <p class="row">
                                        <span class="col-4 fw-bolder">{{ "START_DATE" | translate}} : </span>
                                        <span class="col-8"> {{ oStatisticsData.dStartDate | date:'medium' }}
                                        </span>
                                    </p>
                                    <p class="row" *ngIf="bDisableCountings">
                                        <span class="col-4 fw-bolder">{{ "END_DATE" | translate}} : </span>
                                        <span class="col-8"> {{ oStatisticsData.dEndDate | date:'medium' }} </span>
                                    </p>
                                    <p class="row">
                                        <span class="col-4 fw-bolder">{{ "DISPLAY_METHOD" | translate}} : </span>
                                        <span class="col-8"> {{ sSelectedOptionMenu }} </span>
                                    </p>
                                </div>

                                <div class="col-6 m-0 p-0">
                                    <p class="row">
                                        <span class="col-4 fw-bolder">{{ "LOCATION" | translate}} : </span>
                                        <span class="col-8"> {{ sCurrentLocation }} </span>
                                    </p>
                                    <p class="row">
                                        <span class="col-4 fw-bolder">{{ "WORKSTATION" | translate}} : </span>
                                        <span class="col-8"> {{ sCurrentWorkstation }} </span>
                                    </p>
                                </div>

                            </div>
                        </ng-container>
                    </div> <!-- Card body-->

                </div><!-- Card header-->


                <!-- STATISTICS CODE START -->

                <div class="card card-flush" *ngIf="!aStatistic?.length">
                    <div class="card-header align-items-center py-5 gap-2 gap-md-5">
                        <div class="card-body">
                            <div class="row">
                                <div *ngIf="bStatisticLoading">
                                    <div class="spinner-box h-100">
                                        <div class="three-quarter-spinner">
                                        </div>
                                    </div>
                                </div>
                                <p *ngIf="!bStatisticLoading">{{'NO_STATISTIC_RECORDS_FOUND' | translate}}</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div *ngIf="aStatistic?.length">

                    <!-- LOAD DATA -BEGINS -->
                    <div class="container">

                        <div>
                            <div class="row" *ngIf="aStatistic[0]?.overall?.length">
                                <div class="col-md-4">
                                    <span class="">{{ 'QUANTITY' | translate}}</span>
                                    <h3 class="text-black">{{aStatistic[0].overall[0].nQuantity}}</h3>
                                </div>
                                <div class="col-md-4">
                                    <span class="">{{ 'TOTAL' | translate}}</span>
                                    <h3 class="text-black">{{aStatistic[0].overall[0].nTotalRevenue}}</h3>
                                </div>
                                <div class="col-md-4">
                                    <strong *ngIf="!IsDynamicState">{{ 'STATIC_DATA' | translate }}</strong>
                                    <strong *ngIf="IsDynamicState">{{ 'DYNAMIC_DATA' | translate }}</strong>
                                </div>
                            </div>
                        </div>
                        <hr>
                        <ng-container *ngIf="bShowDownload">
                            <div class="row">
                                <div class="col-md-12">
                                    <div class="d-flex justify-content-end align-items-center">
                                        <ng-container *ngIf="pdfGenerationInProgress">
                                            <div class="spinner-border mx-2"></div>
                                        </ng-container>
                                        <button class="btn btn-primary" (click)="exportToPDF()">{{ 'DOWNLOAD' | translate}}</button>
                                    </div>
                                </div>
                            </div>
                        </ng-container>

                        <div class="row">

                            <div class="card overflow-y-auto" *ngIf="sDisplayMethod === 'revenuePerBusinessPartner'">
                                <p> {{ 'REVENUE_PER_BUSINESS_PARTNER' | translate}} </p>
                                <div class="card-body">
                                    <div class="table-responsive"
                                        *ngFor="let oStatistic of aStatistic; let statisticIndex = index">
                                        <table
                                            class="table table-rounded border border-gray-300 table-row-bordered table-row-gray-300 gy-5 gs-5 text-gray-600"
                                            *ngFor="let oSupplier of oStatistic.individual; let supplierIndex = index">
                                            <thead>
                                                <tr>
                                                    <th><span class="">{{ 'SUPPLIER' | translate}}</span>
                                                        <h3 class="text-black">{{oSupplier.sBusinessPartnerName}}</h3>
                                                    </th>
                                                    <th class="w-150px"><span class="">{{"QUANTITY" | translate}}</span>
                                                        <h4 class="text-black">{{oSupplier.nQuantity}}</h4>
                                                    </th>
                                                    <th class="w-150px"><span class="">{{"PRICE_WITH_VAT" |
                                                            translate}}</span>
                                                        <h4 class="text-black">{{oSupplier.nTotalRevenue | number
                                                            :'1.2-2'}}</h4>
                                                    </th>
                                                    <th class="w-150px"><span class="">{{"PURCHASE_PRICE" |
                                                            translate}}</span>
                                                        <h4 class="text-black">{{oSupplier.nTotalPurchaseAmount | number
                                                            :'1.2-2'}}</h4>
                                                    </th>
                                                    <th class="w-150px"><span class="">{{"GROSS_PROFIT" |
                                                            translate}}</span>
                                                        <h4 class="text-black">{{oSupplier.nProfit | number :'1.2-2'}}
                                                        </h4>
                                                    </th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td colspan="6" class="p-2">
                                                        <table
                                                            class="table table-row-bordered table-row-gray-300 gy-5 gs-5 mb-0 text-gray-600 fw-bold border"
                                                            *ngFor="let oArticleGroup of oSupplier.aArticleGroups; let articleGroupIndex = index">
                                                            <!-- start of articlegroup -->
                                                            <thead class="bg-gray-100">
                                                                <tr class="fw-bold fs-6 text-gray-800">
                                                                    <th scope="col">{{oArticleGroup.sName}}
                                                                        <div class="mx-5">
                                                                            <i *ngIf="!oArticleGroup.bIsCollapseItem"
                                                                                class="px-sm-2 cursor-pointer bi bi-chevron-down"
                                                                                (click)="oArticleGroup.bIsCollapseItem = true;">
                                                                            </i>
                                                                            <i *ngIf="oArticleGroup.bIsCollapseItem"
                                                                                class="px-sm-2 cursor-pointer bi bi-chevron-up"
                                                                                (click)="oArticleGroup.bIsCollapseItem = false;"></i>
                                                                        </div>
                                                                    </th>
                                                                    <th scope="col" class="w-150px">
                                                                        {{oArticleGroup.nQuantity}}</th>
                                                                    <th scope="col" class="w-150px">
                                                                        {{oArticleGroup.nTotalRevenue | number
                                                                        :'1.2-2'}}
                                                                    </th>
                                                                    <th scope="col" class="w-150px">
                                                                        {{oArticleGroup.nTotalPurchaseAmount | number
                                                                        :'1.2-2'}}
                                                                    </th>
                                                                    <th scope="col" class="w-150px">
                                                                        {{oArticleGroup.nProfit| number :'1.2-2'}}</th>

                                                                </tr>
                                                            </thead>
                                                            <ng-container
                                                                *ngIf="oArticleGroup.aRevenueByProperty.length && oArticleGroup.bIsCollapseItem">
                                                                <tbody class="p-2"
                                                                    *ngFor="let oRevenueByProperty of oArticleGroup.aRevenueByProperty; let revenuePropertyIndex = index">
                                                                    <!--start of dyamic property -->
                                                                    <tr>
                                                                        <td class="ps-9">
                                                                            {{oRevenueByProperty.aCategory.join(' |')}}
                                                                        </td>
                                                                        <td>{{oRevenueByProperty.nQuantity}}</td>
                                                                        <td>{{oRevenueByProperty.nTotalRevenue | number
                                                                            :'1.2-2'}}</td>
                                                                        <td>{{oRevenueByProperty.nTotalPurchaseAmount |
                                                                            number :'1.2-2'}}
                                                                        </td>
                                                                        <td>{{oRevenueByProperty.nProfit| number
                                                                            :'1.2-2'}}</td>
                                                                        <td>{{oRevenueByProperty.nMargin}}</td>
                                                                    </tr>
                                                                </tbody>
                                                            </ng-container>
                                                            <!-- start of articlegroup -->
                                                        </table>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>

                            <div class="card" *ngIf="sDisplayMethod === 'revenuePerSupplierAndArticleGroup'">
                                <p> {{ 'REVENUE_PER_SUPPLIER_AND_ARTICLE_GROUP' | translate}} </p>
                                <div class="card-body">
                                    <div class="table-responsive" *ngFor="let oStatistic of aStatistic; let i = index">
                                        <table
                                            class="table table-rounded border border-gray-300 table-row-bordered table-row-gray-300 gy-5 gs-5 text-gray-600"
                                            *ngFor="let oSupplier of oStatistic.individual; let supplierIndex = index">
                                            <thead>
                                                <tr>
                                                    <th><span class="">{{ 'SUPPLIER' | translate}}</span>
                                                        <h3 class="text-black">{{oSupplier.sBusinessPartnerName}}</h3>
                                                    </th>
                                                    <th class="w-150px"><span class="">{{"QUANTITY" | translate}}</span>
                                                        <h4 class="text-black">{{oSupplier.nQuantity}}</h4>
                                                    </th>
                                                    <th class="w-150px"><span class="">{{"PRICE_WITH_VAT" |
                                                            translate}}</span>
                                                        <h4 class="text-black">{{oSupplier.nTotalRevenue | number
                                                            :'1.2-2'}}</h4>
                                                    </th>
                                                    <th class="w-150px"><span class="">{{"PURCHASE_PRICE" |
                                                            translate}}</span>
                                                        <h4 class="text-black">{{oSupplier.nTotalPurchaseAmount | number
                                                            :'1.2-2'}}</h4>
                                                    </th>
                                                    <th class="w-150px"><span class="">{{"GROSS_PROFIT" |
                                                            translate}}</span>
                                                        <h4 class="text-black">{{oSupplier.nProfit | number :'1.2-2' }}
                                                        </h4>
                                                    </th>

                                                </tr>
                                            </thead>

                                            <tbody>
                                                <tr>
                                                    <td colspan="6" class="p-2">
                                                        <table
                                                            class="table table-row-bordered table-row-gray-300 gy-5 gs-5 mb-0 text-gray-600 fw-bold border"
                                                            *ngFor="let oArticleGroup of oSupplier.aArticleGroups; let articleGroupIndex = index">
                                                            <thead class="bg-gray-100">
                                                                <tr class="fw-bold fs-6 text-gray-800">
                                                                    <th scope="col">
                                                                        <div
                                                                            class="d-flex justify-content-between align-items-center">
                                                                            {{oArticleGroup.sName}}
                                                                            <div class="mx-5">
                                                                                <i *ngIf="!oArticleGroup.bIsCollapseItem"
                                                                                    class="px-sm-2 cursor-pointer bi bi-chevron-down"
                                                                                    (click)="expandItem(oArticleGroup, oSupplier.iBusinessPartnerId, 'articlegroup')">
                                                                                </i>
                                                                                <i *ngIf="oArticleGroup.bIsCollapseItem"
                                                                                    class="px-sm-2 cursor-pointer bi bi-chevron-up"
                                                                                    (click)="oArticleGroup.bIsCollapseItem = !oArticleGroup.bIsCollapseItem"></i>
                                                                            </div>
                                                                        </div>

                                                                    </th>
                                                                    <th scope="col" class="w-150px">
                                                                        {{oArticleGroup.nQuantity}}</th>
                                                                    <th scope="col" class="w-150px">
                                                                        {{oArticleGroup.nTotalRevenue | number
                                                                        :'1.2-2'}}
                                                                    </th>
                                                                    <th scope="col" class="w-150px">
                                                                        {{oArticleGroup.nTotalPurchaseAmount | number
                                                                        :'1.2-2'}}
                                                                    </th>
                                                                    <th scope="col" class="w-150px">
                                                                        {{oArticleGroup.nProfit | number :'1.2-2'}}</th>

                                                                </tr>
                                                                <tr *ngIf="oArticleGroup.isLoading">
                                                                    <td colspan="6" class="text-center">
                                                                        <div class="spinner-border mx-auto">
                                                                        </div>
                                                                    </td>
                                                                </tr>
                                                                <ng-container *ngIf="oArticleGroup.bIsCollapseItem">
                                                                    <tr class="bg-white"
                                                                        *ngFor="let item of oArticleGroup.aTransactionItems">
                                                                        <td> {{item.sProductName ||
                                                                            item?.sProductNumber}} </td>
                                                                        <td> {{ item.nQuantity }}</td>
                                                                        <td> {{ item.nRevenueAmount | number :'1.2-2' }}
                                                                        </td>
                                                                        <td> {{ item.nCostOfRevenue | number :'1.2-2' }}
                                                                        </td>
                                                                        <td> {{item.nProfitOfRevenue | number :'1.2-2'}}
                                                                        </td>
                                                                        <td></td>
                                                                    </tr>
                                                                </ng-container>
                                                            </thead>
                                                        </table>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>

                            <div class="card" *ngIf="sDisplayMethod === 'revenuePerArticleGroupAndProperty'">
                                <p> {{ 'REVENUE_PER_ARTICLE_GROUP_AND_PROPERTY' | translate}} </p>
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table
                                            class="table table-rounded border border-gray-300 table-row-bordered table-row-gray-300 gy-5 gs-5 text-gray-600">

                                            <thead>
                                                <tr>
                                                    <th>
                                                        <span class="">{{ 'ARTICLE' | translate}}</span>
                                                        <h4 class="text-black">-</h4>
                                                    </th>
                                                    <th class="w-150px">
                                                        <span class="">{{"QUANTITY" | translate}}</span>
                                                        <h4 class="text-black">{{aStatistic[0]?.overall[0]?.nQuantity}}
                                                        </h4>
                                                    </th>
                                                    <th class="w-150px">
                                                        <span class="">{{"PRICE_WITH_VAT" | translate}}</span>
                                                        <h4 class="text-black">
                                                            {{aStatistic[0]?.overall[0]?.nTotalRevenue | number
                                                            :'1.2-2'}}</h4>
                                                    </th>
                                                    <th class="w-150px">
                                                        <span class="">{{"PURCHASE_PRICE_EX_VAT" | translate}}</span>
                                                        <h4 class="text-black">
                                                            {{aStatistic[0]?.overall[0]?.nTotalPurchaseAmount | number
                                                            :'1.2-2'}}</h4>
                                                    </th>
                                                    <th class="w-150px">
                                                        <span class="">{{"GROSS_PROFIT" | translate}}</span>
                                                        <h4 class="text-black">{{aStatistic[0]?.overall[0]?.nProfit |
                                                            number :'1.2-2'}}</h4>
                                                    </th>

                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td colspan="6" class="p-2">
                                                        <div class="table-responsive"
                                                            *ngFor="let oStatistic of aStatistic; let i = index">
                                                            <table
                                                                class="table table-row-bordered table-row-gray-300 gy-5 gs-5 mb-0 text-gray-600 fw-bold border"
                                                                *ngFor="let oArticleGroup of oStatistic.individual; let articleGroupIndex = index">

                                                                <thead class="bg-gray-100">
                                                                    <tr class="fw-bold fs-6 text-gray-800">
                                                                        <th scope="col">{{oArticleGroup.sName}}</th>
                                                                        <th scope="col" class="w-150px">
                                                                            {{oArticleGroup.nQuantity}}</th>
                                                                        <th scope="col" class="w-150px">
                                                                            {{oArticleGroup.nTotalRevenue | number
                                                                            :'1.2-2'}}</th>
                                                                        <th scope="col" class="w-150px">
                                                                            {{oArticleGroup.nTotalPurchaseAmount |
                                                                            number :'1.2-2'}}
                                                                        </th>
                                                                        <th scope="col" class="w-150px">
                                                                            {{oArticleGroup.nProfit| number
                                                                            :'1.2-2'}}</th>

                                                                    </tr>
                                                                </thead>
                                                                <ng-container
                                                                    *ngIf="oArticleGroup.aRevenueByProperty.length">
                                                                    <tbody class="p-2"
                                                                        *ngFor="let oRevenueByProperty of oArticleGroup.aRevenueByProperty; let revenuePropertyIndex = index">
                                                                        <tr>
                                                                            <td class="ps-9">
                                                                                {{oRevenueByProperty.aCategory.join('
                                                                                |')}}
                                                                            </td>
                                                                            <td>{{oRevenueByProperty.nQuantity}}</td>
                                                                            <td>{{oRevenueByProperty.nTotalRevenue |
                                                                                number :'1.2-2'}}
                                                                            </td>
                                                                            <td>{{oRevenueByProperty.nTotalPurchaseAmount
                                                                                | number :'1.2-2'}}
                                                                            </td>
                                                                            <td>{{oRevenueByProperty.nProfit| number
                                                                                :'1.2-2'}}</td>
                                                                        </tr>
                                                                    </tbody>
                                                                </ng-container>
                                                            </table>
                                                        </div>
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>

                            <div class="card" *ngIf="sDisplayMethod === 'revenuePerProperty'">
                                <p> {{ 'REVENUE_PER_PROPERTY' | translate}} </p>

                                <div class="card-body">
                                    <div class="table-responsive" *ngFor="let oStatistic of aStatistic; let i = index">
                                        <table
                                            class="table table-rounded border border-gray-300 table-row-bordered table-row-gray-300 gy-5 gs-5 text-gray-600">
                                            <thead>
                                                <tr>
                                                    <th>
                                                        <span class="">{{ 'ARTICLE' | translate}}</span>
                                                        <h4 class="text-black">-</h4>
                                                    </th>
                                                    <th class="w-150px">
                                                        <span class="">{{"QUANTITY" | translate}}</span>
                                                        <h4 class="text-black">{{aStatistic[0]?.overall[0]?.nQuantity}}
                                                        </h4>
                                                    </th>
                                                    <th class="w-150px">
                                                        <span class="">{{"PRICE_WITH_VAT" | translate}}</span>
                                                        <h4 class="text-black">
                                                            {{aStatistic[0]?.overall[0]?.nTotalRevenue | number
                                                            :'1.2-2'}}</h4>
                                                    </th>
                                                    <th class="w-150px">
                                                        <span class="">{{"PURCHASE_PRICE_EX_VAT" | translate}}</span>
                                                        <h4 class="text-black">
                                                            {{aStatistic[0]?.overall[0]?.nTotalPurchaseAmount | number
                                                            :'1.2-2'}}</h4>
                                                    </th>
                                                    <th class="w-150px">
                                                        <span class="">{{"GROSS_PROFIT" | translate}}</span>
                                                        <h4 class="text-black">{{aStatistic[0]?.overall[0]?.nProfit |
                                                            number :'1.2-2'}}
                                                        </h4>
                                                    </th>

                                                </tr>
                                            </thead>
                                            <tbody>
                                                <td style="padding:0" colspan="6">
                                                    <table
                                                        class="table table-row-bordered table-row-gray-300 gy-5 gs-5 mb-0 text-gray-600 fw-bold border"
                                                        *ngFor="let oRevenueByProperty of oStatistic.individual; let articleGroupIndex = index">
                                                        <!-- start of article-group -->
                                                        <thead class="bg-gray-100">
                                                            <tr class="fw-bold fs-6 text-gray-800">
                                                                <td>
                                                                    <div
                                                                        class="d-flex justify-content-between align-items-center">
                                                                        {{oRevenueByProperty?.aCategory?.length
                                                                        ?
                                                                        oRevenueByProperty.aCategory.join(' | ') : '-'}}
                                                                        <div class="mx-5">
                                                                            <i *ngIf="!oRevenueByProperty.bIsCollapseItem"
                                                                                class="px-sm-2 cursor-pointer bi bi-chevron-down"
                                                                                (click)="expandItem(oRevenueByProperty)">
                                                                            </i>
                                                                            <i *ngIf="oRevenueByProperty.bIsCollapseItem"
                                                                                class="px-sm-2 cursor-pointer bi bi-chevron-up"
                                                                                (click)="expandItem(oRevenueByProperty)"></i>
                                                                        </div>
                                                                    </div>


                                                                </td>
                                                                <th class="w-150px">
                                                                    {{oRevenueByProperty.sPropertyName}}
                                                                </th>
                                                                <th class="w-150px">
                                                                    {{oRevenueByProperty.nTotalRevenue | number
                                                                    :'1.2-2'}}
                                                                </th>
                                                                <th class="w-150px">
                                                                    {{oRevenueByProperty.nTotalPurchaseAmount | number
                                                                    :'1.2-2'}}</th>
                                                                <th class="w-150px">
                                                                    {{oRevenueByProperty.nProfit| number :'1.2-2'}}</th>

                                                            </tr>
                                                            <tr *ngIf="oRevenueByProperty.isLoading">
                                                                <td colspan="6" class="text-center">
                                                                    <div class="spinner-border mx-auto">
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                            <ng-container *ngIf="oRevenueByProperty.bIsCollapseItem">
                                                                <tr class="bg-white"
                                                                    *ngFor="let item of oRevenueByProperty.aTransactionItems">
                                                                    <td> {{item.sProductName || item?.sProductNumber}}
                                                                    </td>
                                                                    <td> {{ item.nQuantity }}</td>
                                                                    <td> {{ item.nRevenueAmount | number :'1.2-2'}}</td>
                                                                    <td> {{ item.nCostOfRevenue | number :'1.2-2'}}</td>
                                                                    <td>{{item.nProfitOfRevenue | number :'1.2-2'}}</td>
                                                                    <td></td>
                                                                </tr>
                                                                <tr
                                                                    *ngIf="!oRevenueByProperty?.aTransactionItems?.length && !oRevenueByProperty.isLoading">
                                                                    <td colspan="6" class="text-center"> {{
                                                                        "NO_DATA_FOUND" | translate}}
                                                                    </td>
                                                                </tr>
                                                            </ng-container>
                                                        </thead>
                                                    </table>
                                                </td>
                                            </tbody>
                                        </table>

                                    </div>
                                </div>
                            </div>

                            <div class="card" *ngIf="sDisplayMethod === 'revenuePerArticleGroup'">
                                <p> {{ 'REVENUE_PER_ARTICLE_GROUP' | translate}} </p>
                                <div class="card-body">
                                    <div class="table-responsive" *ngFor="let oStatistic of aStatistic; let i = index">
                                        <table
                                            class="table table-rounded border border-gray-300 table-row-bordered table-row-gray-300 gy-5 gs-5 text-gray-600">
                                            <thead>
                                                <tr>
                                                    <th>
                                                        <span class="">{{ 'ARTICLE' | translate}}</span>
                                                        <h4 class="text-black">-</h4>
                                                    </th>
                                                    <th class="w-150px">
                                                        <span class="">{{"QUANTITY" | translate}}</span>
                                                        <h4 class="text-black">{{aStatistic[0]?.overall[0]?.nQuantity}}
                                                        </h4>
                                                    </th>
                                                    <th class="w-150px">
                                                        <span class="">{{"PRICE_WITH_VAT" | translate}}</span>
                                                        <h4 class="text-black">
                                                            {{aStatistic[0]?.overall[0]?.nTotalRevenue | number
                                                            :'1.2-2'}}</h4>
                                                    </th>
                                                    <th class="w-150px">
                                                        <span class="">{{"PURCHASE_PRICE_EX_VAT" | translate}}</span>
                                                        <h4 class="text-black">
                                                            {{aStatistic[0]?.overall[0]?.nTotalPurchaseAmount | number
                                                            :'1.2-2'}}</h4>
                                                    </th>
                                                    <th class="w-150px">
                                                        <span class="">{{"GROSS_PROFIT" | translate}}</span>
                                                        <h4 class="text-black">{{aStatistic[0]?.overall[0]?.nProfit |
                                                            number
                                                            :'1.2-2'}}
                                                        </h4>
                                                    </th>

                                                </tr>
                                            </thead>
                                            <tbody>
                                                <td style="padding:0" colspan="6">
                                                    <table
                                                        class="table table-row-bordered table-row-gray-300 gy-5 gs-5 mb-0 text-gray-600 fw-bold border"
                                                        *ngFor="let oArticleGroup of oStatistic.individual; let articleGroupIndex = index">
                                                        <!-- start of articlegroup -->
                                                        <tbody class="bg-gray-100">
                                                            <tr class="fw-bold fs-6 text-gray-800">
                                                                <td>
                                                                    <div
                                                                        class="d-flex justify-content-between align-items-center">
                                                                        {{oArticleGroup.sName}}
                                                                        <div class="mx-5">
                                                                            <i *ngIf="!oArticleGroup.bIsCollapseItem"
                                                                                class="px-sm-2 cursor-pointer bi bi-chevron-down"
                                                                                (click)="expandItem(oArticleGroup)">
                                                                            </i>
                                                                            <i *ngIf="oArticleGroup.bIsCollapseItem"
                                                                                class="px-sm-2 cursor-pointer bi bi-chevron-up"
                                                                                (click)="expandItem(oArticleGroup)"></i>
                                                                        </div>
                                                                    </div>

                                                                </td>
                                                                <td class="w-150px">{{oArticleGroup.nQuantity}}</td>
                                                                <td class="w-150px">{{oArticleGroup.nTotalRevenue |
                                                                    number :'1.2-2'}}</td>
                                                                <td class="w-150px">
                                                                    {{oArticleGroup.nTotalPurchaseAmount | number
                                                                    :'1.2-2'}}</td>
                                                                <td class="w-150px">{{oArticleGroup.nProfit | number
                                                                    :'1.2-2'}}</td>
                                                                <!-- <td class="w-150px">{{oArticleGroup.nMargin}}</td> -->
                                                            </tr>
                                                            <tr *ngIf="oArticleGroup.isLoading">
                                                                <td colspan="6" class="text-center">
                                                                    <div class="spinner-border mx-auto">
                                                                    </div>
                                                                </td>
                                                            </tr>
                                                            <ng-container *ngIf="oArticleGroup.bIsCollapseItem">
                                                                <tr class="bg-white"
                                                                    *ngFor="let item of oArticleGroup.aTransactionItems">
                                                                    <td> {{item.sProductName || item?.sProductNumber}}</td>
                                                                    <td class="w-150px"> {{ item.nQuantity }}</td>
                                                                    <td class="w-150px"> {{ item.nRevenueAmount | number :'1.2-2'}}</td>
                                                                    <td class="w-150px"> {{ item.nCostOfRevenue | number :'1.2-2'}}</td>
                                                                    <td class="w-150px">{{item.nProfitOfRevenue | number :'1.2-2'}}</td>
                                                                    <!-- <td></td> -->
                                                                </tr>
                                                            </ng-container>
                                                        </tbody>
                                                        <!-- end of articlegroup -->
                                                    </table>
                                                </td>
                                            </tbody>
                                        </table>


                                    </div>
                                </div>
                            </div>

                            <div class="card" *ngIf="sDisplayMethod === 'aVatRates'">
                                <p> {{ 'VAT_RATES' | translate}} </p>

                                <div class="card-body">
                                    <div class="table-responsive" *ngFor="let oStatistic of aStatistic; let i = index">
                                        <table
                                            class="table table-rounded border border-gray-300 table-row-bordered table-row-gray-300 gy-5 gs-5 text-gray-600">
                                            <thead>
                                                <tr>
                                                    <th><span class="">{{ 'VAT_TYPE' | translate}}</span></th>
                                                    <th class="w-150px"><span class="">{{ "PRICE_WITH_VAT" |
                                                            translate}}</span></th>
                                                    <th class="w-150px"><span class="">{{ "PURCHASE_PRICE_EX_VAT" |
                                                            translate}}</span></th>
                                                    <th class="w-150px"><span class="">{{ "GROSS_PROFIT" |
                                                            translate}}</span></th>
                                                    <th class="w-150px"><span class="">{{"VAT_AMOUNT" |
                                                            translate}}</span>
                                                    </th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <td style="padding:0" colspan="6">
                                                    <ng-container
                                                        *ngFor="let oVatRate of oStatistic.aVatRates; let vatRateIndex = index">
                                                        <table
                                                            class="table table-row-bordered table-row-gray-300 gy-5 gs-5 mb-0 text-gray-600 fw-bold border">
                                                            <tr>
                                                                <td class="text-center fw-bolder bg-gray-100"
                                                                    colspan="5">
                                                                    {{"VAT_RATE" | translate}} - {{oVatRate?.nVat}}
                                                                </td>
                                                            </tr>
                                                            <tr>
                                                                <ng-container [ngTemplateOutlet]="vatRateTemplates"
                                                                    [ngTemplateOutletContext]="{ data: {sVatMethod: 'oShopPurchase', oVatRate: oVatRate} }"
                                                                    *ngIf="optionMenu === 'cash-registry'">
                                                                </ng-container>
                                                            </tr>
                                                            <tr>
                                                                <ng-container [ngTemplateOutlet]="vatRateTemplates"
                                                                    [ngTemplateOutletContext]="{ data: {sVatMethod: 'oWebShop', oVatRate: oVatRate} }"
                                                                    *ngIf="optionMenu === 'cash-registry'">
                                                                </ng-container>
                                                            </tr>
                                                            <tr>
                                                                <ng-container [ngTemplateOutlet]="vatRateTemplates"
                                                                    [ngTemplateOutletContext]="{ data: {sVatMethod: 'oDeliverySupplier', oVatRate: oVatRate} }"
                                                                    *ngIf="optionMenu === 'purchase-order' && sUserType === 'supplier'">
                                                                </ng-container>
                                                            </tr>
                                                            <tr>
                                                                <ng-container [ngTemplateOutlet]="vatRateTemplates"
                                                                    [ngTemplateOutletContext]="{ data: {sVatMethod: 'oDeliveryRetailer', oVatRate: oVatRate} }"
                                                                    *ngIf="optionMenu === 'purchase-order' && sUserType === 'retailer'">
                                                                </ng-container>
                                                            </tr>
                                                            <tr>
                                                                <ng-container [ngTemplateOutlet]="vatRateTemplates"
                                                                    [ngTemplateOutletContext]="{ data: {sVatMethod: 'oSalesOrderSupplier', oVatRate: oVatRate} }"
                                                                    *ngIf="optionMenu === 'sales-order'">
                                                                </ng-container>
                                                            </tr>
                                                        </table>
                                                    </ng-container>
                                                </td>
                                            </tbody>
                                        </table>

                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                    <!-- LOAD DATA -END -->

                    <!-- VAT-RATES TEMPLATE BEGIN -->
                    <ng-template let-data="data" #vatRateTemplates>
                        <!-- <p>Dear {{person.name}} , {{person.message}} </p> -->
                        <td><span class="">{{ data?.sVatMethod }}</span></td>
                        <td class="w-150px"><span class="">{{ data?.oVatRate[data?.sVatMethod].nTotalRevenue | number
                                :'1.2-2' }}</span>
                        </td>
                        <td class="w-150px"><span class="">{{ data?.oVatRate[data?.sVatMethod].nPurchaseValue | number
                                :'1.2-2' }}</span>
                        </td>
                        <td class="w-150px"><span class="">{{ data?.oVatRate[data?.sVatMethod].nProfit| number :'1.2-2'
                                }}</span></td>
                        <td class="w-150px"><span class="">{{ data?.oVatRate[data?.sVatMethod].nVatAmount }}</span></td>
                    </ng-template>

                </div>
                <!-- STATISTICS CODE END -->

                <!-- PAYMENT START -->
                <div class="card">
                    <div class="container">
                        <div class="d-flex justify-content-between">
                            <strong> {{ 'PAYMENT_METHODS' | translate}} </strong>
                            <ng-container
                                *ngIf="iStatisticId && oStatisticsDocument?.bIsDayState && aPaymentMethods?.length">
                                <button class="btn" (click)="toggleEditPaymentMode()">
                                    <i class="fa fa-edit"></i>
                                </button>
                            </ng-container>
                        </div>
                        <p *ngIf="!aPaymentMethods?.length">{{ 'PAYMENT_METHODS_NOT_FOUND' | translate}}</p>
                        <div *ngIf="aPaymentMethods?.length">
                            <div class="card-body">
                                <table
                                    class="table table-row-bordered table-row-gray-300 gy-5 gs-5 mb-0 text-gray-600 fw-bold border">
                                    <thead class="bg-gray-100">
                                        <tr class="fw-bold fs-6 text-gray-800">
                                            <th>{{ 'METHOD' | translate}}</th>
                                            <th class="w-150px">{{ 'AMOUNT' | translate}}</th>
                                            <th *ngIf="paymentEditMode" class="w-150px">{{ 'NEW AMOUNT' | translate}}
                                            </th>
                                            <th class="w-150px">{{ 'QUANTITY' | translate}}</th>
                                        </tr>
                                    </thead>
                                    <tbody class="p-2">
                                        <ng-container *ngFor="let oPayment of aPaymentMethods; let i = index">
                                            <tr>
                                                <td class="ps-9 d-flex justify-content-between">
                                                    {{oPayment.sMethod}}
                                                    <div class="">
                                                        <i *ngIf="!oPayment.bIsCollapseItem" class="px-sm-2 cursor-pointer bi bi-chevron-down"
                                                            (click)="expandItem(oPayment, oPayment.iStatisticsId, 'payments')">
                                                        </i>
                                                        <i *ngIf="oPayment.bIsCollapseItem" class="px-sm-2 cursor-pointer bi bi-chevron-up"
                                                            (click)="oPayment.bIsCollapseItem = !oPayment.bIsCollapseItem"></i>
                                                    </div>
                                                </td>
                                                <td>{{oPayment.nAmount}}</td>
                                                <td *ngIf="paymentEditMode">
                                                    <input class="form-control" type="number" [(ngModel)]="oPayment.nNewAmount"
                                                        (ngModelChange)="reCalculateTotal()">
                                                </td>
                                                <td>{{oPayment.nQuantity}}</td>
                                            </tr>
                                            <tr *ngIf="oPayment.isLoading">
                                                <td colspan="6" class="text-center">
                                                    <div class="spinner-border mx-auto">
                                                    </div>
                                                </td>
                                            </tr>
                                            <ng-container *ngIf="oPayment.bIsCollapseItem">
                                                <tr class="bg-gray-100" *ngFor="let item of oPayment.aItems">
                                                    <td class="ps-9"> {{ item.sComment}} {{ (!item?.sComment || item.sComment === '') ? item.sMethod : '' }}</td>
                                                    <td> {{ item.nAmount }}</td>
                                                    <td> {{ item.nQuantity }}</td>
                                                </tr>
                                            </ng-container>
                                        </ng-container>
                                        <ng-container *ngIf="paymentEditMode">
                                            <tr *ngFor="let oPayment of aNewSelectedPaymentMethods; let i = index">
                                                <td>
                                                    <div>
                                                        <ng-select [(ngModel)]="aNewSelectedPaymentMethods[i]" [clearable]="false">
                                                            <ng-option [value]="option" *ngFor="let option of payMethods">
                                                                {{ option.sName | translate }}
                                                            </ng-option>
                                                        </ng-select>
                                                    </div>
                                                </td>
                                                <td></td>
                                                <td>
                                                    <input class="form-control" type="number" [(ngModel)]="oPayment.nAmount"
                                                        (ngModelChange)="reCalculateTotal()">
                                                </td>
                                            </tr>
                                            <tr>
                                                <td colspan="3" class="text-start">
                                                    <span class="cursor-pointer text-gray-800" (click)="addRow()"> +
                                                        {{ "CLICK_HERE_TO_ADD_MORE" | translate}}</span>
                                                </td>
                                            </tr>
                                        </ng-container>
                                    </tbody>
                                    <tfoot>
                                        <tr>
                                            <th class="text-end">{{ 'TOTAL' | translate}}</th>
                                            <th class="w-150px">{{ nPaymentMethodTotal }}</th>
                                            <ng-container *ngIf="paymentEditMode">
                                                <th>
                                                    <span
                                                        [ngClass]="nNewPaymentMethodTotal === nPaymentMethodTotal ? 'valid' : 'invalid' ">{{
                                                        nNewPaymentMethodTotal }}</span>
                                                </th>
                                                <th class="w-150px">
                                                    <button class="btn btn-sm btn-primary"
                                                        (click)="saveUpdatedPayments($event)"> {{ "SAVE" |
                                                        translate}}</button>
                                                </th>
                                            </ng-container>
                                        </tr>
                                    </tfoot>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- PAYMENT END -->

                <!-- STOCK HISTORY START -->
                <div class="card">
                    <div class="container">
                        <div class="d-flex justify-content-between">
                            <strong> {{ 'STOCK_HISTORY' | translate}} </strong>
                        </div>
                        <p *ngIf="!oStockPerLocation.aHistory">{{ 'STOCK_HISTORY_NOT_FOUND' | translate}}</p>
                        <div *ngIf="oStockPerLocation.aHistory">
                            <div class="card-body">
                                <table
                                    class="table table-row-bordered table-row-gray-300 gy-5 gs-5 mb-0 text-gray-600 fw-bold border">
                                    <thead class="bg-gray-100">
                                        <tr class="fw-bold fs-6 text-gray-800">
                                            <th>{{ 'LOCATION_NAME' | translate}}</th>
                                            <th class="w-150px">{{ 'PURCHASE_PRICE' | translate}} -
                                                {{oStockPerLocation.nTotalPurchasePrice | number:'1.2-2'}}</th>
                                        </tr>
                                    </thead>
                                    <tbody class="p-2">
                                        <tr *ngFor="let oHistory of oStockPerLocation.aHistory; let i = index">
                                            <td class="ps-9">{{oHistory.sName ? oHistory.sName : '-' }}</td>
                                            <td>{{oHistory.nPurchasePrice | number:'1.2-2'}}</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- STOCK HISTORY END -->

                <!-- Tushar's code START -->
                <ng-container
                    *ngIf="sDisplayMethod === this.edisplayMethodKeysEnum.revenuePerBusinessPartner || sDisplayMethod === this.edisplayMethodKeysEnum.revenuePerArticleGroupAndProperty">

                    <div class="card-body pt-0">
                        <div class="dataTables_wrapper dt-bootstrap4 no-footer">
                            <div class="table-responsive">
                                <table class="table align-middle table-row-dashed fs-6 gy-5 dataTable no-footer">
                                    <thead>
                                        <tr class="text-start text-gray-400 fw-bolder fs-7 text-uppercase gs-0">
                                            <th class="min-w-100px sorting" tabindex="0">{{ "STATISTICS_OVERALL" |
                                                translate}}
                                            </th>
                                            <th class="min-w-100px sorting" tabindex="0">{{ "STATISTICS_VALUE" |
                                                translate}}
                                            </th>
                                            <th class="min-w-100px sorting" tabindex="0">{{ "BOOKKEEPING_VALUE" |
                                                translate
                                                }}
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody class="fw-bold text-gray-600">
                                        <tr class="even">
                                            <td>
                                                <span>{{ "TOTAL_REVENUE" | translate}}</span>
                                            </td>
                                            <td>
                                            </td>
                                            <td>
                                            </td>
                                        </tr>
                                        <tr class="even">
                                            <td>
                                                <span>{{ "QUANTITY" | translate}}</span>
                                            </td>
                                            <td>
                                            </td>
                                            <td>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>

                                <hr>
                                <h4>{{ "TRANSACTIONS" | translate}}</h4>
                                <table
                                    class="table table-green align-middle table-row-dashed fs-6 gy-5 dataTable no-footer">
                                    <thead style="position: sticky;">
                                        <tr class="text-start text-gray-400 fw-bolder fs-7 text-uppercase gs-0">
                                            <th class="min-w-100px sorting" tabindex="0">{{ "BOOKING_DATE" | translate}}
                                            </th>
                                            <th class="min-w-100px sorting" tabindex="0">{{ "LEDGER_NUMBER" |
                                                translate}}
                                            </th>
                                            <th class="min-w-100px sorting" tabindex="0">{{ "CREDIT" | translate}} </th>
                                            <th class="min-w-100px sorting" tabindex="0">{{ "DEBIT" | translate }}</th>
                                        </tr>
                                    </thead>
                                    <tbody class="fw-bold text-gray-600">
                                        <tr class="even" *ngFor="let booking of bookingRecords">
                                            <td>
                                                <span>{{booking.dTransactionCreationDate | date: 'medium'}}</span>
                                            </td>
                                            <td>
                                                <span>{{booking.nLedgerNumber}}</span>
                                            </td>
                                            <td>
                                                <span>{{ booking.eType === 'credit' ? (booking.nValue | number:'2.1-5'):
                                                    '-'}}</span>
                                            </td>
                                            <td>
                                                <span>{{booking.eType === 'debit' ? (booking.nValue | number:'2.1-5'):
                                                    '-'
                                                    }}</span>
                                            </td>
                                        </tr>
                                    </tbody>
                                    <tfoot style="position: sticky;">
                                        <tr class="even">
                                            <td>
                                                <span>{{ "TOTAL" | translate}}</span>
                                            </td>
                                            <td>
                                                <span>-</span>
                                            </td>
                                            <td>
                                                <span>{{creditAmount}}</span>
                                            </td>
                                            <td>
                                                <span>{{debitAmount}}</span>
                                            </td>
                                        </tr>
                                    </tfoot>
                                </table>
                                <hr>
                                <h4>{{ "PAYMENTS" | translate}}</h4>
                                <table
                                    class="table table-green align-middle table-row-dashed fs-6 gy-5 dataTable no-footer">
                                    <thead style="position: sticky;">
                                        <tr class="text-start text-gray-400 fw-bolder fs-7 text-uppercase gs-0">
                                            <th class="min-w-100px sorting" tabindex="0">{{ "BOOKING_DATE" | translate}}
                                            </th>
                                            <th class="min-w-100px sorting" tabindex="0">{{ "LEDGER_NUMBER" |
                                                translate}}
                                            </th>
                                            <th class="min-w-100px sorting" tabindex="0">{{ "CREDIT" | translate}} </th>
                                            <th class="min-w-100px sorting" tabindex="0">{{ "DEBIT" | translate }}</th>
                                        </tr>
                                    </thead>
                                    <tbody class="fw-bold text-gray-600">
                                        <tr class="even" *ngFor="let booking of paymentRecords">
                                            <td>
                                                <span>{{booking.dTransactionCreationDate | date: 'medium'}}</span>
                                            </td>
                                            <td>
                                                <span>{{booking.nLedgerNumber}}</span>
                                            </td>
                                            <td>
                                                <span>{{ booking.eType === 'credit' ? (booking.nValue | number:'2.1-5'):
                                                    '-'}}</span>
                                            </td>
                                            <td>
                                                <span>{{booking.eType === 'debit' ? (booking.nValue | number:'2.1-5'):
                                                    '-'
                                                    }}</span>
                                            </td>
                                        </tr>
                                    </tbody>
                                    <tfoot style="position: sticky;">
                                        <tr class="even">
                                            <td>
                                                <span>{{ "TOTAL" | translate}}</span>
                                            </td>
                                            <td>
                                                <span>-</span>
                                            </td>
                                            <td>
                                                <span>{{paymentCreditAmount}}</span>
                                            </td>
                                            <td>
                                                <span>{{paymentDebitAmount}}</span>
                                            </td>
                                        </tr>
                                    </tfoot>
                                </table>
                            </div>
                        </div>
                    </div>
                </ng-container>
                <!-- Tushar's code END -->

            </div>
        </div>
    </div>
    <ng-container *ngIf="iStatisticId">
        <!-- COUNTING SECTION START -->
        <div class="row">
            <div class="card card-flush">
                <div class="row">
                    <div class="col-md-6">
                        <div class="card-header align-items-center p-5">
                            <div class="card-title col-md-12">
                                <h4>{{ "COUNTING" | translate}}</h4>
                            </div>
                        </div>
                        <div class="card-body p-5">
                            <div class="counting-list mb-5">
                                <table style="display: block;column-count: 2">
                                    <tbody>
                                        <tr *ngFor="let amount of aAmount">
                                            <td class="w-50">
                                                <label class="currency">
                                                    {{ amount.sLabel | currency: transactionAuditPdfService.currency }} x
                                                </label>
                                            </td>
                                            <td class="mx-2">
                                                <input type="number" class="form-control p-2"
                                                    [(ngModel)]="amount.nQuantity"
                                                    (ngModelChange)="calculateTotalCounting()"
                                                    [disabled]="bDisableCountings">
                                            </td>
                                            <td class="w-50">
                                                <label class="currency">{{ (amount.nQuantity * amount.nValue) | currency: transactionAuditPdfService.currency}}</label>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>

                            </div>
                            <ng-container *ngIf="oStatisticsDocument">
                                <div class="d-flex flex-wrap">
                                    <label>{{'NOTES' | translate}}</label>
                                    <div class="flex-grow-1 ms-5">
                                        <textarea class="form-control" rows="5" [disabled]="bDisableCountings"
                                            [(ngModel)]="oStatisticsDocument.sComment"></textarea>
                                    </div>
                                </div>
                            </ng-container>
                        </div>

                    </div>
                    <div class="col-md-6">
                        <div class="card-header align-items-center p-5">
                            <div class="card-title col-md-12">
                                <h4> {{ "EARNINGS" | translate}} </h4>
                            </div>
                        </div>
                        <div class="card-body">

                            <div class="earnings-section">
                                <div>
                                    <label>{{ "CASH_LEFTOVER" | translate}}</label>
                                    <label class="">{{ oCountings.nCashAtStart | currency: transactionAuditPdfService.currency }}</label>
                                </div>
                                <div>
                                    <label>{{ "CASH_MUTATION" | translate}}</label>
                                    <label class="">{{ '0.00' | currency: transactionAuditPdfService.currency }}</label>
                                </div>
                                <div>
                                    <label>{{ "CASH_IN_TILL" | translate}}</label>
                                    <label class="">
                                        <ng-container *ngIf="bDisableCountings">
                                            {{ oCountings.nCashInTill + (-oCountings.nCashDifference) | currency: transactionAuditPdfService.currency }}
                                        </ng-container>
                                        <ng-container *ngIf="!bDisableCountings">
                                            {{ oCountings.nCashInTill | currency: transactionAuditPdfService.currency }}
                                        </ng-container>
                                    </label>
                                </div>
                                <div>
                                    <label>{{ "CASH_COUNTED" | translate}}</label>
                                    <input type="number" class="form-control p-2 w-30"
                                        [(ngModel)]="oCountings.nCashCounted"
                                        (ngModelChange)="oCountings.nCashRemain = oCountings.nCashCounted - oCountings.nSkim"
                                        [disabled]="bDisableCountings">
                                </div>
                                <div>
                                    <label>{{ "TREASURY_DIFFERENCE" | translate}}</label>
                                    <label class="bold">
                                        <ng-container *ngIf="bDisableCountings">
                                            {{ oCountings.nCashDifference | currency: transactionAuditPdfService.currency }}
                                        </ng-container>
                                        <ng-container *ngIf="!bDisableCountings">
                                            {{ oCountings.nCashCounted - (oCountings.nCashAtStart + oCountings.nCashInTill) | currency: transactionAuditPdfService.currency }}
                                        </ng-container>
                                    </label>
                                </div>
                                <div>
                                    <label>{{ "SKIM" | translate}}</label>
                                    <input type="number" class="form-control p-2 w-30" [(ngModel)]="oCountings.nSkim"
                                        (ngModelChange)="oCountings.nCashRemain = oCountings.nCashCounted - oCountings.nSkim"
                                        [disabled]="bDisableCountings">
                                </div>
                                <div>
                                    <label>{{ "AMOUNT_TO_LEFT_IN_CASH" | translate}}</label>
                                    <input type="number" class="form-control p-2 w-30"
                                        [(ngModel)]="oCountings.nCashRemain"
                                        (ngModelChange)="oCountings.nSkim = oCountings.nCashCounted - oCountings.nCashRemain"
                                        [disabled]="bDisableCountings">
                                </div>
                                <br>
                                <ng-container *ngIf="oStatisticsDocument?.bIsDayState">
                                    <div class="d-flex justify-content-start">
                                        <button type="button" class="btn btn-primary"
                                            data-kt-roles-modal-action="submit" (click)="closeDayState()"
                                            [class.disabled]="closingDayState">
                                            <span class="indicator-label">{{ "CLOSE_DAYSTATE" | translate}}</span>
                                        </button>
                                        <div *ngIf="closingDayState" class="spinner-border mx-5"></div>
                                    </div>
                                </ng-container>

                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- COUNTING SECTION END -->
    </ng-container>
</div>
