<div class="card shadow-sm">
    <div class="card-header" style="margin-top: 20px;">
        <h4>{{ 'ACTIVITY_DETAILS' | translate}}</h4>
        <div mat-dialog-actions>
            <button mat-dialog-close type="button" class="btn btn-sm btn-light" (click)="close(false)">
                <fa-icon [icon]="faTimes"></fa-icon>
            </button>
        </div>
    </div>
    <div class="card-body bg-light-gray">
        <div class="row">
            <div class="col-2"></div>
            <div class="col-10">
                <h4> {{ "ACTIVITIES" | translate}}</h4>
            </div>
        </div>
        <div class="row">
            <div class="col-2 pe-0">
                <div class="card pt-2" > <!-- style="width: 18rem;" -->
                    <span class="card-header justify-content-center align-items-center text-center m-0 ps-0 pe-0">
                        <h3>{{activity.sNumber}}</h3>
                    </span>

                    <div class="card-body p-3">

                        <div *ngIf="bShowOrderDownload">
                            <button class="btn btn-primary" (click)="downloadReceipt($event)">{{ 'DOWNLOAD' | translate }}</button>
                            <div class="spinner-border mx-2" *ngIf="bActivityPdfGenerationInProgress"></div>
                        </div>

                        <div class="d-flex flex-wrap py-5">
                            <div class="flex-equal me-5">
                                {{ "CUSTOMER_DETAILS" | translate}}
                                <div class="fs-6 ms-1">
                                    <div class="align-items-center">
                                        <div class="text-gray-600">{{customer?.sFirstName || ''}} {{customer?.sLastName || ''}}</div>
                                    </div>
                                </div>
                                <div class="fs-6 ms-1">
                                    <div class="align-items-center">
                                        <div class="text-gray-600">{{customer?.sEmail || ''}}<a
                                                href="mailto:{{customer?.sEmail}}">
                                                <fa-icon [icon]="faEnvelope"></fa-icon>
                                            </a></div>
                                    </div>
                                </div>
                                <div class="fs-6 ms-1">
                                    <div class="align-items-center">
                                        {{'PHONE_MOBILE' | translate}}
                                        <span>{{customer?.oPhone?.sMobile}}
                                            <i class="fab fa-whatsapp ms-1" *ngIf="customer?.oPhone?.bWhatsApp"
                                                style="color: #1CB39B;"></i>
                                        </span>
                                    </div>
                                </div>
                                <div class="fs-6 ms-1">
                                    <div class="align-items-center">
                                        {{'PHONE_LANDLINE' | translate}}
                                        <span>{{customer?.oPhone?.sLandLine}}
                                        </span>
                                    </div>
                                </div>

                                <div class="fs-6 ms-1">
                                    <div class="align-items-center">
                                        {{'Advised by' | translate}}
                                        <span>{{customer?.oPhone?.sLandLine}}
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="d-flex flex-wrap py-5">
                            <div class="flex-equal me-5">
                                {{ 'CREATER_DETAIL' | translate}}

                                <div class="d-flex fs-6 ms-1 my-1">
                                    <div class="align-items-center">
                                        <img alt="Logo"
                                            *ngIf="createrDetail?.sFirstName && (!createrDetail?.sAvatar  || createrDetail.sAvatar == '')"
                                            src="https://prismanote.com/public/prismanote.png" class="createrImage">
                                        <img alt="Logo" *ngIf="createrDetail?.sAvatar" [src]="createrDetail.sAvatar"
                                            class="createrImage">
                                        <span> {{createrDetail?.sFirstName || ''}} {{createrDetail?.sLastName || ''}}
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-10">

                <div class="accordion" id="kt_accordion_1">
                    <div class="accordion-item" *ngFor="let activity of activityItems; index as index">
                        <div *ngIf="!eKindValue.includes(activity.oType.eKind)">
                            <h2 class="accordion-header">
                                <button class="accordion-button fs-4 fw-bold"
                                    (click)="activity.collapsedBtn = !activity.collapsedBtn" type="button"
                                    data-bs-toggle="collapse" [ngClass]="{'collapsed': activity.collapsedBtn }"
                                    #accordionBtn>
                                    <label>{{activity.sNumber}}
                                        <button [cdkCopyToClipboard]="activity.sNumber"
                                            (cdkCopyToClipboardCopied)="bActivityNumber=true" class="btn">
                                            <i class="fa fa-copy" title="Click to copy"> </i>
                                        </button>
                                        <span *ngIf="bActivityNumber" class="text-green bold text-end my-2">Copied to
                                            clipboard!</span>
                                    </label>
                                </button>
                            </h2>
                            <div class="accordion-collapse collapse"
                                *ngIf="eKindValueForLayout.includes(activity.oType.eKind)" data-bs-parent="accordion"
                                [ngClass]="{'show': activity.collapsedBtn }">
                                <div class="accordion-body">
                                    <div class="row">
                                        <div class="col-4">
                                            <div class="form-group mb-6">
                                                <label class="form-control-label mb-3">{{ "NAME" | translate}}</label>
                                                <input class="form-control form-control-solid mb-3 mb-lg-0" type="text"
                                                    name="activityName" [(ngModel)]="activity.sProductName">
                                            </div>
                                            <div class="form-group mb-6">
                                                <label class="form-control-label mb-3">{{ "DESCRIPTION" |
                                                    translate}}</label>
                                                <textarea class="form-control form-control-solid" name="description"
                                                    placeholder="{{ 'DESCRIPTION' | translate}}" lines="10"
                                                    [(ngModel)]="activity.sDescription"></textarea>
                                            </div>

                                        </div>
                                        <div class="col-5">

                                            <div class="form-group mb-6">
                                                <label class="form-control-label mb-3">{{ "STATUS" | translate}}
                                                </label>
                                                <select name="status" id="status"
                                                    class="form-control form-control-solid"
                                                    [(ngModel)]="activity.eActivityItemStatus">
                                                    <option *ngFor="let type of repairStatus" [value]="type.value">{{type.key | translate}}
                                                    </option>
                                                </select>
                                            </div>

                                            <div>
                                                {{"INFORM_CUSTOMER_THAT_PRODUCT_CAN_BE_PICKED_UP" | translate}}
                                            </div>
                                            <div class="border p-3 mb-5">
                                                <div class="border p-1 my-3 px-4">
                                                    {{ "TO_BE_PAID(EXCL_FEES)" | translate}}
                                                </div>
                                                <div class="row">
                                                    <div class="col-8">
                                                        <input class="form-control form-control-solid w-100"
                                                            type="number" [(ngModel)]="activity.nTotalAmount">
                                                    </div>
                                                    <div class="col-4">
                                                        <button class="btn btn-primary">{{ "MAIL_CUSTOMER" |
                                                            translate}}</button>
                                                    </div>
                                                </div>
                                                <div class="row mt-2">
                                                    <div class="col-6">
                                                        {{"ALREADY_PAID" | translate}}: {{activity.nPaidAmount |
                                                        currency:tillService.currency}}
                                                    </div>
                                                    <div class="col-6">
                                                        {{"STILL_TO_PAY" | translate}}: {{(activity.nTotalAmount -
                                                        activity.nPaidAmount) | currency:tillService.currency}}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-3 my-3">
                                            <div class="btn-group me-4 w-100 my-3">
                                                <span class="btn btn-primary fs-bold"
                                                    (click)="downloadCustomerReceipt(index)">
                                                    <fa-icon class="group-icon" [icon]="faUser"></fa-icon>
                                                    <span class="indicator-label ">{{ "CUSTOMER_RECEIPT" | translate
                                                        }}</span>
                                                </span>

                                                <span class="btn btn-primary btn-icon fs-bold" role="button">
                                                    <div class="btn btn-icon show menu-dropdown"
                                                        data-kt-menu-trigger="click" data-kt-menu-attach="parent"
                                                        data-kt-menu-placement="bottom-end" data-kt-menu-flip="bottom">
                                                        <span class="svg-icon svg-icon-2 m-0">
                                                            <svg xmlns="http://www.w3.org/2000/svg" width="24"
                                                                height="24" viewBox="0 0 24 24" fill="none">
                                                                <path
                                                                    d="M11.4343 12.7344L7.25 8.55005C6.83579 8.13583 6.16421 8.13584 5.75 8.55005C5.33579 8.96426 5.33579 9.63583 5.75 10.05L11.2929 15.5929C11.6834 15.9835 12.3166 15.9835 12.7071 15.5929L18.25 10.05C18.6642 9.63584 18.6642 8.96426 18.25 8.55005C17.8358 8.13584 17.1642 8.13584 16.75 8.55005L12.5657 12.7344C12.2533 13.0468 11.7467 13.0468 11.4343 12.7344Z"
                                                                    fill="black"></path>
                                                            </svg>
                                                        </span>
                                                    </div>
                                                    <div class="menu menu-sub menu-sub-dropdown menu-column menu-rounded menu-gray-600 menu-state-bg-light-primary fw-bold fs-7 w-200px py-4"
                                                        data-kt-menu="true">
                                                        <div class="menu-item px-3 text-center">
                                                            <div class="menu-link px-3">tMenu</div>
                                                        </div>
                                                        <div class="menu-item px-3 text-center">
                                                            <div class="menu-link px-3">tMenu</div>
                                                        </div>
                                                    </div>
                                                </span>
                                            </div>
                                            <div class="btn-group me-4 w-100 my-3">
                                                <span class="btn btn-primary fs-bold"
                                                    (click)="downloadCustomerReceipt(index)">
                                                    <fa-icon class="group-icon" [icon]="faPrint"></fa-icon>
                                                    <span class="indicator-label">{{
                                                        "CUSTOMER_RECEIPT_PRINT" |
                                                        translate}}</span>
                                                </span>

                                                <span class="btn btn-primary btn-icon fs-bold printer-button-span"
                                                    role="button">
                                                    <div class="btn btn-icon" data-kt-menu-trigger="click"
                                                        data-kt-menu-attach="parent"
                                                        data-kt-menu-placement="bottom-start"
                                                        data-kt-menu-flip="bottom">
                                                        <span class="svg-icon svg-icon-2 m-0">
                                                            <svg xmlns="http://www.w3.org/2000/svg" width="24"
                                                                height="24" viewBox="0 0 24 24" fill="none">
                                                                <path
                                                                    d="M11.4343 12.7344L7.25 8.55005C6.83579 8.13583 6.16421 8.13584 5.75 8.55005C5.33579 8.96426 5.33579 9.63583 5.75 10.05L11.2929 15.5929C11.6834 15.9835 12.3166 15.9835 12.7071 15.5929L18.25 10.05C18.6642 9.63584 18.6642 8.96426 18.25 8.55005C17.8358 8.13584 17.1642 8.13584 16.75 8.55005L12.5657 12.7344C12.2533 13.0468 11.7467 13.0468 11.4343 12.7344Z"
                                                                    fill="black"></path>
                                                            </svg>
                                                        </span>
                                                    </div>
                                                    <div class="menu menu-sub menu-sub-dropdown menu-column menu-rounded menu-gray-600 menu-state-bg-light-primary fw-bold fs-7 w-200px py-4"
                                                        data-kt-menu="true">
                                                        <div class="menu-item px-3 text-center">
                                                            <div class="menu-link px-3">tMenu</div>
                                                        </div>
                                                    </div>
                                                </span>
                                            </div>
                                            <div class="btn-group me-4 w-100 my-3">
                                                <span class="btn btn-primary fs-bold">
                                                    <fa-icon class="group-icon" [icon]="faReceipt"></fa-icon>
                                                    <span class="indicator-label">{{ "RECEIPT_PARTNER" |
                                                        translate}}</span>
                                                </span>
                                                <span class="btn btn-primary btn-icon fs-bold" role="button">
                                                    <div class="btn btn-icon" data-kt-menu-trigger="click"
                                                        data-kt-menu-attach="parent"
                                                        data-kt-menu-placement="bottom-start"
                                                        data-kt-menu-flip="bottom">
                                                        <span class="svg-icon svg-icon-2 m-0">
                                                            <svg xmlns="http://www.w3.org/2000/svg" width="24"
                                                                height="24" viewBox="0 0 24 24" fill="none">
                                                                <path
                                                                    d="M11.4343 12.7344L7.25 8.55005C6.83579 8.13583 6.16421 8.13584 5.75 8.55005C5.33579 8.96426 5.33579 9.63583 5.75 10.05L11.2929 15.5929C11.6834 15.9835 12.3166 15.9835 12.7071 15.5929L18.25 10.05C18.6642 9.63584 18.6642 8.96426 18.25 8.55005C17.8358 8.13584 17.1642 8.13584 16.75 8.55005L12.5657 12.7344C12.2533 13.0468 11.7467 13.0468 11.4343 12.7344Z"
                                                                    fill="black"></path>
                                                            </svg>
                                                        </span>
                                                    </div>
                                                    <div class="menu menu-sub menu-sub-dropdown menu-column menu-rounded menu-gray-600 menu-state-bg-light-primary fw-bold fs-7 w-200px py-4"
                                                        data-kt-menu="true">
                                                        <div class="menu-item px-3 text-center">
                                                            <div class="menu-link px-3">tMenu</div>
                                                        </div>
                                                    </div>
                                                </span>
                                            </div>
                                            <div class="btn-group me-4 w-100 my-3">
                                                <span class="btn btn-primary fs-bold">
                                                    <span>
                                                        <fa-icon class="group-icon" [icon]="faReceipt"></fa-icon>
                                                    </span>
                                                    <span class="indicator-label">{{ "RECEIPT_FOR_BOTH" |
                                                        translate}}</span>
                                                </span>
                                                <span class="btn btn-primary btn-icon fs-bold" role="button">
                                                    <div class="btn btn-icon" data-kt-menu-trigger="click"
                                                        data-kt-menu-attach="parent"
                                                        data-kt-menu-placement="bottom-start"
                                                        data-kt-menu-flip="bottom">
                                                        <span class="svg-icon svg-icon-2 m-0">
                                                            <svg xmlns="http://www.w3.org/2000/svg" width="24"
                                                                height="24" viewBox="0 0 24 24" fill="none">
                                                                <path
                                                                    d="M11.4343 12.7344L7.25 8.55005C6.83579 8.13583 6.16421 8.13584 5.75 8.55005C5.33579 8.96426 5.33579 9.63583 5.75 10.05L11.2929 15.5929C11.6834 15.9835 12.3166 15.9835 12.7071 15.5929L18.25 10.05C18.6642 9.63584 18.6642 8.96426 18.25 8.55005C17.8358 8.13584 17.1642 8.13584 16.75 8.55005L12.5657 12.7344C12.2533 13.0468 11.7467 13.0468 11.4343 12.7344Z"
                                                                    fill="black"></path>
                                                            </svg>
                                                        </span>
                                                    </div>
                                                    <div class="menu menu-sub menu-sub-dropdown menu-column menu-rounded menu-gray-600 menu-state-bg-light-primary fw-bold fs-7 w-200px py-4"
                                                        data-kt-menu="true">
                                                        <div class="menu-item px-3 text-center">
                                                            <div class="menu-link px-3">tMenu</div>
                                                        </div>
                                                    </div>
                                                </span>
                                            </div>
                                            <div class="btn-group me-4 w-100 my-3">
                                                <span class="btn btn-primary fs-bold">
                                                    <fa-icon class="group-icon" [icon]="faEnvelope"></fa-icon>
                                                    <span class="indicator-label">{{ "MAIL" | translate}}</span>
                                                </span>
                                            </div>
                                            <div class="btn-group me-4 w-100 my-3">
                                                <span class="btn btn-primary fs-bold"
                                                    (click)="loadCashRegister = true; openTransaction(activity, 'activity')">
                                                    <fa-icon class="group-icon" [icon]="faEuro"></fa-icon>
                                                    <span class="indicator-label">{{ "CHECKOUT" | translate}}</span>
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                    <div *ngIf="activity.eRepairStatus === 'completed'"
                                        class="col-md-12 card-body d-flex flex-wrap py-5 border mt-5 mb-5 row">
                                        <div class="col-md-8">
                                            <div class="">
                                                <span>{{ "SHIPPING_METHOD" | translate }} : </span>
                                                <label class="form-control form-control-solid-solid">{{
                                                    "STANDARD_SHIPPING"
                                                    | translate}}</label>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <label>{{ "CARRIER" | translate}}</label>
                                                </div>
                                                <div class="col-md-6">
                                                    <select name="career" id="career"
                                                        class="form-select form-select-solid">
                                                        <option>PostNL</option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <input type="text" class="form-control form-control-solid"
                                                    placeholder="www.trackandtracelink.com">
                                            </div>
                                            <div class="row">
                                                <label>{{ "PLACE_TRACKING_CODE" | translate}}</label>
                                            </div>
                                            <div class="row">
                                                <label>{{ "OPEN_TRACKING_LINK" | translate}}</label>
                                            </div>
                                        </div>
                                        <div class="col-md-4 gap-5">
                                            <button class="btn btn-primary w-100 d-flex">
                                                <label class="mx-auto">{{ "SEND_TO_CUSTOMER" | translate}}</label>
                                            </button>
                                            <button class="btn btn-secondary w-100 d-flex">
                                                <label class="mx-auto"> {{ "READY_TO_PICKUP" | translate}}</label>
                                            </button>
                                            <button class="btn btn-secondary w-100 d-flex">
                                                <label class="mx-auto">{{ "DELIVER" | translate}}</label>
                                            </button>
                                            <button *ngIf="webOrders" class="btn btn-primary w-100 d-flex"
                                                (click)="openTransaction(activity, 'activity')">
                                                <label class="mx-auto"> {{ "OPEN_ACTIVITY" | translate}}</label>
                                            </button>
                                        </div>
                                    </div>

                                    <div class="row my-5">
                                        <div class="col">
                                            <div class="form-group w-100">
                                                <input type="text" name="activityName"
                                                    [(ngModel)]="activity.sProductName"
                                                    class="form-control form-control-solid">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">

                                        <div class="col-5">
                                            <div class="row mb-6">
                                                <label class="col-lg-4 col-form-label fw-bold fs-6">{{ "INTAKE_DATE" |
                                                    translate}}</label>
                                                <div class="col-lg-8">
                                                    <div class="row">
                                                        <div class="col-lg-8 fv-row">
                                                            <input type="date"
                                                                class="form-control form-control form-control-solid"
                                                                name="dCreatedDate"
                                                                [ngModel]="activity.dCreatedDate | date:'yyyy-MM-dd'"
                                                                (ngModelChange)="activity.dCreatedDate = $event"
                                                                readonly />

                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row mb-6">
                                                <label class="col-lg-4 col-form-label fw-bold fs-6">{{"LOCATION" |
                                                    translate}}</label>
                                                <div class="col-lg-8">
                                                    <div class="row">
                                                        <div class="col-lg-8 fv-row">
                                                            <input type="text"
                                                                class="form-control form-control-lg form-control-solid mb-3 mb-lg-0 w-100"
                                                                [(ngModel)]="oLocationName" placeholder="" readonly />
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row mb-6">
                                                <label class="col-lg-4 col-form-label fw-bold fs-6">{{
                                                    "ESTIMATED_DATE_READY" | translate}}</label>
                                                <div class="col-lg-8">
                                                    <div class="row">
                                                        <div class="col-lg-8 fv-row">

                                                            <input type="date"
                                                                class="form-control form-control form-control-solid"
                                                                name="dEstimatedDate"
                                                                [ngModel]="activity.dEstimatedDate | date:'yyyy-MM-dd'"
                                                                (ngModelChange)="activity.dEstimatedDate = $event" />
                                                            <!-- <input type="text"
                                                            class="form-control form-control-lg form-control-solid mb-3 mb-lg-0 w-100"
                                                            [(ngModel)]="activity.dEstimatedDate" placeholder=""> -->
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row mb-6">
                                                <label class="col-lg-4 col-form-label fw-bold fs-6">{{
                                                    "CONTACT_WHEN_READY"
                                                    | translate}}</label>
                                                <div class="col-lg-8">
                                                    <div class="row">
                                                        <div class="col-lg-8 fv-row">
                                                            {{ "INTAKE_DATE" | translate}}
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row mb-6">
                                                <label class="col-lg-4 col-form-label fw-bold fs-6"> {{
                                                    "ESTIMATED_PRICE_UPON_INGESTION" | translate}}</label>
                                                <div class="col-lg-8">
                                                    <div class="row">
                                                        <div class="col-lg-8 fv-row">
                                                            <input type="number"
                                                                class="form-control form-control-lg form-control-solid mb-3 mb-lg-0 w-100"
                                                                [(ngModel)]="activity.nPriceIncVat" placeholder="">
                                                            <p *ngIf="activity?.oType?.bDiscount">Discount price
                                                                {{activity.nPriceIncVat - activity.nTotalAmount |
                                                                currency:tillService.currency }} </p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row mb-6">
                                                <label class="col-lg-4 col-form-label fw-bold fs-6">
                                                    {{"TO_BE_PAID(EXCL_FEES)" | translate}} - 1</label>
                                                <div class="col-lg-8">
                                                    <div class="row">
                                                        <div class="col-lg-8 fv-row">
                                                            <input type="number"
                                                                class="form-control form-control-lg form-control-solid mb-3 mb-lg-0 w-100"
                                                                [(ngModel)]="activity.nPriceIncVat"
                                                                (input)="changeTotalAmount(activity)">
                                                            <p *ngIf="activity?.oType?.bDiscount">Discount price
                                                                {{activity.nPriceIncVat - activity.nTotalAmount |
                                                                currency:tillService.currency }} </p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="table-responsive">
                                                <table
                                                    class="table align-middle table-row-dashed fs-6 gy-5 dataTable no-footer">
                                                    <thead>
                                                        <tr
                                                            class="text-start text-gray-400 fw-bolder fs-7 text-uppercase gs-0">
                                                            <th>{{ "RECEIPT_NUMBER" | translate}}</th>
                                                            <th>{{ "CREATED_DATE" | translate}}</th>
                                                            <th>{{ "AMOUNT" |translate}}</th>
                                                            <ng-container *ngIf="from != 'transaction-details'">
                                                                <th>{{ 'ACTION' | translate }}</th>
                                                            </ng-container>
                                                        </tr>
                                                    </thead>
                                                    <tbody class="fw-bold text-gray-600">
                                                        <tr *ngFor='let receipt of activity.receipts'>
                                                            <td>{{receipt.sTransactionNumber}}</td>
                                                            <td>{{receipt.dCreatedDate | date: 'medium'}}</td>
                                                            <td>{{receipt.nPaymentAmount | currency:
                                                                tillService.currency}}</td>
                                                            <ng-container *ngIf="from != 'transaction-details'">
                                                                <td>
                                                                    <div class="d-flex align-items-center">
                                                                        <button class="btn btn-primary"
                                                                            (click)="showTransaction(receipt, $event)">
                                                                            {{ 'VIEW' | translate }}
                                                                        </button>
                                                                        <div *ngIf="receipt.bFetchingTransaction"
                                                                            class="spinner-border mx-2"></div>
                                                                    </div>
                                                                </td>
                                                            </ng-container>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                        <div class="col-3">
                                            <div class="row mb-6">
                                                <div class="col-12">
                                                    <div *ngIf="!activity?.aImage?.length">
                                                        {{"NO_IMAGES" | translate}}
                                                    </div>
                                                    <div class="d-flex">
                                                        <div class="image-input p-1 d-flex"
                                                            *ngFor="let image of activity.aImage; let i = index"
                                                            data-kt-image-input="true"
                                                            style="background-image: url('assets/media/svg/avatars/blank.svg')">
                                                            <div class="image-input-wrapper w-100px h-100px"
                                                                style="background-image: url(assets/media/avatars/300-1.jpg)">
                                                                <img src={{image}} width="100px" height="100px">
                                                            </div>
                                                            <div class="mt-2 ">
                                                                <div data-kt-image-input-action="reorder"
                                                                    class="d-flex">
                                                                    <button
                                                                        class="btn btn-icon btn-circle btn-active-color-primary w-25px h-25px bg-body shadow"
                                                                        data-kt-image-input-action="remove"
                                                                        data-bs-toggle="tooltip" title="Remove image">
                                                                        <i class="bi bi-x fs-2"></i>
                                                                    </button>
                                                                </div>

                                                            </div>


                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row mb-6" *ngIf="activity.oType.eKind == 'order'">
                                                <div class="col-12">
                                                    {{'PRODUCT_SELECTED' | translate}}
                                                </div>
                                                <div class="col-12">
                                                    <label>{{'PRODUCT_NUMBER' | translate}} : </label>
                                                    <span
                                                        *ngIf="activity?.iBusinessProductId">{{activity?.sProductNumber}}
                                                    </span>
                                                    <span
                                                        *ngIf="activity?.iBusinessProductId == undefined">{{'NO_PRODUCT_SELECTED'
                                                        | translate}} </span>
                                                </div>
                                                <div class="col-12">
                                                    <label>{{'ARTICLE_DETAIL' | translate}} : </label>
                                                    {{activity?.sArticleNumber}} - {{activity?.sArticleName}}
                                                </div>
                                                <div class="col-12">
                                                    <button class="btn btn-success"
                                                        (click)="AssignOrderProduct(activity , index)"> {{'ADD / CHANGE'
                                                        | translate}}</button>
                                                </div>
                                            </div>

                                        </div>
                                        <div class="col-4">
                                            <div class="row mb-6">
                                                <label class="col-lg-4 col-form-label fw-bold fs-6">{{ "REPAIR_NUMBER"
                                                    |translate}}</label>
                                                <div class="col-lg-8">
                                                    <div class="row">
                                                        <div class="col-lg-8 fv-row">
                                                            <input type="text"
                                                                class="form-control form-control-lg form-control-solid mb-3 mb-lg-0 w-100"
                                                                [(ngModel)]="activity.sBagNumber" placeholder="">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row mb-6">
                                                <label class="col-lg-4 col-form-label fw-bold fs-6">{{
                                                    "COST_INCURRED(EXCL_VAT)" | translate}}</label>
                                                <div class="col-lg-8">
                                                    <div class="row">
                                                        <div class="col-lg-8 fv-row">
                                                            <input type="number"
                                                                class="form-control form-control-lg form-control-solid mb-3 mb-lg-0 w-100"
                                                                [(ngModel)]="activity.nPriceIncVat" placeholder="">
                                                            <p *ngIf="activity?.oType?.bDiscount">Discount price
                                                                {{activity.nPriceIncVat - activity.nTotalAmount |
                                                                currency:tillService.currency }} </p>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="row">

                                                    <div class="fw-bold fs-6 my-2">
                                                        {{ "I_REPAIR_THIS_MYSELF" | translate}}
                                                    </div>
                                                    <div class="col">

                                                        <div class="row mb-6">
                                                            <label class="col-lg-4 col-form-label fw-bold fs-6">{{
                                                                "REPAIRER" |
                                                                translate}}</label>
                                                            <div class="col-lg-8">
                                                                <div class="row ">
                                                                    <div class="col-lg-8 fv-row">
                                                                        <ng-select *ngIf="!activity.iAssigneeId"
                                                                            [(ngModel)]="activity.iAssigneeId"
                                                                            (search)="searchEmployees($event.term)"
                                                                            class="form-control form-control-solid p-0 w-100 custom"
                                                                            placeholder="{{ 'SEARCH_EMPLOYEE' | translate}}"
                                                                            [minTermLength]="2" [clearable]="false"
                                                                            [isOpen]="filteredEmployees.length > 0"
                                                                            (change)="onEmployeeChange($event , index)">
                                                                            <ng-option
                                                                                *ngFor="let option of filteredEmployees"
                                                                                [value]="option">
                                                                                {{option.sName ||
                                                                                'Unknown'}}</ng-option>
                                                                        </ng-select>

                                                                        <div class="chip d-flex"
                                                                            *ngIf="activity.iAssigneeId">
                                                                            {{activity.employeeName}}
                                                                            <div (click)="removeEmployeees(index)">
                                                                                &nbsp;<i
                                                                                    class="close fas fa-times cursor-pointer"></i>
                                                                            </div>
                                                                        </div>

                                                                    </div>
                                                                </div>
                                                                <div class="row my-4">
                                                                    <div class="col-md-8 text-center">
                                                                        <label>{{ "OR" | translate}}</label>
                                                                    </div>
                                                                </div>
                                                                <div class="row">
                                                                    <div class="col-lg-8 fv-row">
                                                                        <ng-select *ngIf="!activity.iBusinessPartnerId"
                                                                            [(ngModel)]="activity.iBusinessPartnerId"
                                                                            (search)="searchSuppliers($event.term)"
                                                                            class="form-control form-control-solid p-0 w-100 custom"
                                                                            placeholder="{{'SEARCH_REPAIRER' | translate}}"
                                                                            [minTermLength]="2" [clearable]="false"
                                                                            [isOpen]="supplierOptions.length > 0"
                                                                            (change)="onSupplierChange($event,index)">
                                                                            <ng-option
                                                                                *ngFor="let option of supplierOptions"
                                                                                [value]="option">
                                                                                {{option.sName ||
                                                                                'Unknown'}}</ng-option>
                                                                        </ng-select>
                                                                        <div class="chip d-flex"
                                                                            *ngIf="activity.iBusinessPartnerId">
                                                                            {{activity.sBusinessPartnerName}}
                                                                            <div (click)="removeSuppliers(index)">
                                                                                &nbsp;<i
                                                                                    class="close fas fa-times cursor-pointer"></i>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>

                                                        <div class="row mb-6">
                                                            <label class="col-lg-4 col-form-label fw-bold fs-6"><label
                                                                    for="brand">{{ "BRAND" | translate}}</label></label>
                                                            <div class="col-lg-8">
                                                                <div class="row">
                                                                    <div class="col-lg-8 fv-row">
                                                                        <ng-select *ngIf="!activity.iBusinessBrandId"
                                                                            [(ngModel)]="activity.iBusinessBrandId"
                                                                            (search)="searchBrands($event.term)"
                                                                            class="form-control form-control-solid p-0 w-100 custom"
                                                                            placeholder="{{'SEARCH_BRAND' | translate }}"
                                                                            [minTermLength]="2" [clearable]="false"
                                                                            [isOpen]="filteredBrands.length > 0"
                                                                            (change)="onBrandChange($event, index)">
                                                                            <ng-option
                                                                                *ngFor="let option of filteredBrands"
                                                                                [value]="option">
                                                                                {{option.sName ||
                                                                                'Unknown'}}</ng-option>
                                                                        </ng-select>
                                                                        <div class="chip d-flex"
                                                                            *ngIf="activity.iBusinessBrandId">
                                                                            {{activity.brandName}}
                                                                            <div (click)="removeBrands(index)">
                                                                                &nbsp;<i
                                                                                    class="close fas fa-times cursor-pointer"></i>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>



                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="row">
                                            <div class="col-6">
                                                <div class="row mb-6">
                                                    <label class="col-lg-12 col-form-label fw-bold fs-6">{{
                                                        "REMARK_FOR_SERVICE_PARTNERS" | translate}}</label>
                                                    <div class="col-lg-12">
                                                        <div class="row">
                                                            <div class="col-lg-12 fv-row">
                                                                <textarea
                                                                    class="form-control form-control-lg form-control-solid mb-3 mb-lg-0 w-100"
                                                                    placeholder="{{ 'REMARK_FOR_SERVICE_PARTNERS' | translate}}"
                                                                    lines="10"
                                                                    [(ngModel)]="activity.sCommentVisibleServicePartner"></textarea>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-6">
                                                <div class="row mb-6">
                                                    <label class="col-lg-12 col-form-label fw-bold fs-6">{{
                                                        "REMARK_FOR_COLLEAGUES" |
                                                        translate}}</label>
                                                    <div class="col-lg-12">
                                                        <div class="row">
                                                            <div class="col-lg-12 fv-row">
                                                                <textarea
                                                                    class="form-control form-control-lg form-control-solid mb-3 mb-lg-0 w-100"
                                                                    placeholder="{{ 'REMARK_FOR_SERVICE_PARTNERS' | translate}}"
                                                                    lines="10"
                                                                    [(ngModel)]="activity.sCommentVisibleCollegues"></textarea>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                        </div>
                                        <div class="row">
                                            <div class="col-3">
                                                <button class="btn btn-primary" (click)="submit(activity._id , index)"
                                                    type="submit"> {{ "SUBMIT" | translate}}</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="accordion-collapse collapse" *ngIf="activity.oType.eKind == 'giftcard'"
                                data-bs-parent="accordion" [ngClass]="{'show': activity.collapsedBtn }">
                                <div class="accordion-body">
                                    <div class="row">
                                        <div class="col-4">
                                            <div class="form-group mb-6">
                                                <label class="form-control-label mb-3">{{ "NAME" | translate}}</label>
                                                <input class="form-control form-control-solid mb-3 mb-lg-0" type="text"
                                                    name="activityName" [(ngModel)]="activity.sProductName">
                                            </div>
                                            <div class="form-group mb-6">
                                                <label class="form-control-label mb-3">{{ "DESCRIPTION" |
                                                    translate}}</label>
                                                <textarea class="form-control form-control-solid" name="description"
                                                    placeholder="{{ 'DESCRIPTION' | translate}}" lines="10"
                                                    [(ngModel)]="activity.sDescription"></textarea>
                                            </div>
                                            <div class="form-group mb-6">
                                                {{'REMAINING_AMOUNT' | translate}} : {{activity.nPaidAmount |
                                                currency:tillService.currency}}
                                            </div>

                                        </div>
                                        <div class="col-5">

                                            <div class="form-group mb-6">
                                                <label class="form-control-label mb-3">{{ "GIFT_CARD_NUMBER" |
                                                    translate}} </label>
                                                <input type="text" name="giftCardNumber"
                                                    class="form-control form-control-solid mb-3 mb-lg-0"
                                                    [(ngModel)]="activity.sGiftCardNumber" readonly />
                                            </div>

                                            <div>
                                                {{"INFORM_CUSTOMER_THAT_PRODUCT_CAN_BE_PICKED_UP" | translate}}
                                            </div>
                                            <div class="border p-3 mb-5">
                                                <div class="border p-1 my-3 px-4">
                                                    {{ "TO_BE_PAID(EXCL_FEES)" | translate}}
                                                </div>
                                                <div class="row">
                                                    <div class="col-8">
                                                        <input class="form-control form-control-solid w-100"
                                                            type="number" [(ngModel)]="activity.nTotalAmount">
                                                    </div>
                                                    <div class="col-4">
                                                        <button class="btn btn-primary">{{ "MAIL_CUSTOMER" |
                                                            translate}}</button>
                                                    </div>
                                                </div>
                                                <div class="row mt-2">
                                                    <div class="col-6">
                                                        {{"ALREADY_PAID" | translate}}: {{activity.nPaidAmount |
                                                        currency:
                                                        tillService.currency}}
                                                    </div>
                                                    <div class="col-6">
                                                        {{"STILL_TO_PAY" | translate}}: {{(activity.nTotalAmount -
                                                        activity.nPaidAmount)
                                                        |
                                                        currency:
                                                        tillService.currency}}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-3 my-3">
                                            <div class="btn-group me-4 w-100 my-3">
                                                <span class="btn btn-primary fs-bold"
                                                    (click)="downloadCustomerReceipt(index)">
                                                    <fa-icon class="group-icon" [icon]="faUser"></fa-icon>
                                                    <span class="indicator-label ">{{ "CUSTOMER_RECEIPT" | translate
                                                        }}</span>
                                                </span>

                                                <span class="btn btn-primary btn-icon fs-bold" role="button">
                                                    <div class="btn btn-icon" data-kt-menu-trigger="click"
                                                        data-kt-menu-attach="parent" data-kt-menu-placement="bottom-end"
                                                        data-kt-menu-flip="bottom">
                                                        <span class="svg-icon svg-icon-2 m-0">
                                                            <svg xmlns="http://www.w3.org/2000/svg" width="24"
                                                                height="24" viewBox="0 0 24 24" fill="none">
                                                                <path
                                                                    d="M11.4343 12.7344L7.25 8.55005C6.83579 8.13583 6.16421 8.13584 5.75 8.55005C5.33579 8.96426 5.33579 9.63583 5.75 10.05L11.2929 15.5929C11.6834 15.9835 12.3166 15.9835 12.7071 15.5929L18.25 10.05C18.6642 9.63584 18.6642 8.96426 18.25 8.55005C17.8358 8.13584 17.1642 8.13584 16.75 8.55005L12.5657 12.7344C12.2533 13.0468 11.7467 13.0468 11.4343 12.7344Z"
                                                                    fill="black"></path>
                                                            </svg>
                                                        </span>
                                                    </div>
                                                    <div class="menu menu-sub menu-sub-dropdown menu-column menu-rounded menu-gray-600 menu-state-bg-light-primary fw-bold fs-7 w-200px py-4"
                                                        data-kt-menu="true">
                                                        <div class="menu-item px-3 text-center">
                                                            <div class="menu-link px-3">tMenu</div>
                                                        </div>
                                                        <div class="menu-item px-3 text-center">
                                                            <div class="menu-link px-3">tMenu</div>
                                                        </div>
                                                    </div>
                                                </span>
                                            </div>
                                            <div class="btn-group me-4 w-100 my-3">
                                                <span class="btn btn-primary fs-bold"
                                                    (click)="downloadCustomerReceipt(index)">
                                                    <fa-icon class="group-icon" [icon]="faPrint"></fa-icon>
                                                    <span class="indicator-label">{{
                                                        "CUSTOMER_RECEIPT_PRINT" |
                                                        translate}}</span>
                                                </span>

                                                <span class="btn btn-primary btn-icon fs-bold printer-button-span"
                                                    role="button">
                                                    <div class="btn btn-icon" data-kt-menu-trigger="click"
                                                        data-kt-menu-attach="parent"
                                                        data-kt-menu-placement="bottom-start"
                                                        data-kt-menu-flip="bottom">
                                                        <span class="svg-icon svg-icon-2 m-0">
                                                            <svg xmlns="http://www.w3.org/2000/svg" width="24"
                                                                height="24" viewBox="0 0 24 24" fill="none">
                                                                <path
                                                                    d="M11.4343 12.7344L7.25 8.55005C6.83579 8.13583 6.16421 8.13584 5.75 8.55005C5.33579 8.96426 5.33579 9.63583 5.75 10.05L11.2929 15.5929C11.6834 15.9835 12.3166 15.9835 12.7071 15.5929L18.25 10.05C18.6642 9.63584 18.6642 8.96426 18.25 8.55005C17.8358 8.13584 17.1642 8.13584 16.75 8.55005L12.5657 12.7344C12.2533 13.0468 11.7467 13.0468 11.4343 12.7344Z"
                                                                    fill="black"></path>
                                                            </svg>
                                                        </span>
                                                    </div>
                                                    <div class="menu menu-sub menu-sub-dropdown menu-column menu-rounded menu-gray-600 menu-state-bg-light-primary fw-bold fs-7 w-200px py-4"
                                                        data-kt-menu="true">
                                                        <div class="menu-item px-3 text-center">
                                                            <div class="menu-link px-3">tMenu</div>
                                                        </div>
                                                    </div>
                                                </span>
                                            </div>
                                            <div class="btn-group me-4 w-100 my-3">
                                                <span class="btn btn-primary fs-bold">
                                                    <fa-icon class="group-icon" [icon]="faReceipt"></fa-icon>
                                                    <span class="indicator-label">{{ "RECEIPT_PARTNER" |
                                                        translate}}</span>
                                                </span>
                                                <span class="btn btn-primary btn-icon fs-bold" role="button">
                                                    <div class="btn btn-icon" data-kt-menu-trigger="click"
                                                        data-kt-menu-attach="parent"
                                                        data-kt-menu-placement="bottom-start"
                                                        data-kt-menu-flip="bottom">
                                                        <span class="svg-icon svg-icon-2 m-0">
                                                            <svg xmlns="http://www.w3.org/2000/svg" width="24"
                                                                height="24" viewBox="0 0 24 24" fill="none">
                                                                <path
                                                                    d="M11.4343 12.7344L7.25 8.55005C6.83579 8.13583 6.16421 8.13584 5.75 8.55005C5.33579 8.96426 5.33579 9.63583 5.75 10.05L11.2929 15.5929C11.6834 15.9835 12.3166 15.9835 12.7071 15.5929L18.25 10.05C18.6642 9.63584 18.6642 8.96426 18.25 8.55005C17.8358 8.13584 17.1642 8.13584 16.75 8.55005L12.5657 12.7344C12.2533 13.0468 11.7467 13.0468 11.4343 12.7344Z"
                                                                    fill="black"></path>
                                                            </svg>
                                                        </span>
                                                    </div>
                                                    <div class="menu menu-sub menu-sub-dropdown menu-column menu-rounded menu-gray-600 menu-state-bg-light-primary fw-bold fs-7 w-200px py-4"
                                                        data-kt-menu="true">
                                                        <div class="menu-item px-3 text-center">
                                                            <div class="menu-link px-3">tMenu</div>
                                                        </div>
                                                    </div>
                                                </span>
                                            </div>
                                            <div class="btn-group me-4 w-100 my-3">
                                                <span class="btn btn-primary fs-bold">
                                                    <span>
                                                        <fa-icon class="group-icon" [icon]="faReceipt"></fa-icon>
                                                    </span>
                                                    <span class="indicator-label">{{ "RECEIPT_FOR_BOTH" |
                                                        translate}}</span>
                                                </span>
                                                <span class="btn btn-primary btn-icon fs-bold" role="button">
                                                    <div class="btn btn-icon" data-kt-menu-trigger="click"
                                                        data-kt-menu-attach="parent"
                                                        data-kt-menu-placement="bottom-start"
                                                        data-kt-menu-flip="bottom">
                                                        <span class="svg-icon svg-icon-2 m-0">
                                                            <svg xmlns="http://www.w3.org/2000/svg" width="24"
                                                                height="24" viewBox="0 0 24 24" fill="none">
                                                                <path
                                                                    d="M11.4343 12.7344L7.25 8.55005C6.83579 8.13583 6.16421 8.13584 5.75 8.55005C5.33579 8.96426 5.33579 9.63583 5.75 10.05L11.2929 15.5929C11.6834 15.9835 12.3166 15.9835 12.7071 15.5929L18.25 10.05C18.6642 9.63584 18.6642 8.96426 18.25 8.55005C17.8358 8.13584 17.1642 8.13584 16.75 8.55005L12.5657 12.7344C12.2533 13.0468 11.7467 13.0468 11.4343 12.7344Z"
                                                                    fill="black"></path>
                                                            </svg>
                                                        </span>
                                                    </div>
                                                    <div class="menu menu-sub menu-sub-dropdown menu-column menu-rounded menu-gray-600 menu-state-bg-light-primary fw-bold fs-7 w-200px py-4"
                                                        data-kt-menu="true">
                                                        <div class="menu-item px-3 text-center">
                                                            <div class="menu-link px-3">tMenu</div>
                                                        </div>
                                                    </div>
                                                </span>
                                            </div>
                                            <div class="btn-group me-4 w-100 my-3">
                                                <span class="btn btn-primary fs-bold">
                                                    <fa-icon class="group-icon" [icon]="faEnvelope"></fa-icon>
                                                    <span class="indicator-label">{{ "MAIL" | translate}}</span>
                                                </span>
                                            </div>
                                            <div class="btn-group me-4 w-100 my-3">
                                                <span class="btn btn-primary fs-bold"
                                                    (click)="loadCashRegister = true; openTransaction(activity, 'activity')">
                                                    <fa-icon class="group-icon" [icon]="faEuro"></fa-icon>
                                                    <span class="indicator-label">{{ "CHECKOUT" | translate}}</span>
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                    <div *ngIf="activity.eRepairStatus === 'completed'"
                                        class="col-md-12 card-body d-flex flex-wrap py-5 border mt-5 mb-5 row">
                                        <div class="col-md-8">
                                            <div class="">
                                                <span>{{ "SHIPPING_METHOD" | translate }} : </span>
                                                <label class="form-control form-control-solid-solid">{{
                                                    "STANDARD_SHIPPING"
                                                    | translate}}</label>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <label>{{ "CARRIER" | translate}}</label>
                                                </div>
                                                <div class="col-md-6">
                                                    <select name="career" id="career"
                                                        class="form-select form-select-solid">
                                                        <option>PostNL</option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <input type="text" class="form-control form-control-solid"
                                                    placeholder="www.trackandtracelink.com">
                                            </div>
                                            <div class="row">
                                                <label>{{ "PLACE_TRACKING_CODE" | translate}}</label>
                                            </div>
                                            <div class="row">
                                                <label>{{ "OPEN_TRACKING_LINK" | translate}}</label>
                                            </div>
                                        </div>
                                        <div class="col-md-4 gap-5">
                                            <button class="btn btn-primary w-100 d-flex">
                                                <label class="mx-auto">{{ "SEND_TO_CUSTOMER" | translate}}</label>
                                            </button>
                                            <button class="btn btn-secondary w-100 d-flex">
                                                <label class="mx-auto"> {{ "READY_TO_PICKUP" | translate}}</label>
                                            </button>
                                            <button class="btn btn-secondary w-100 d-flex">
                                                <label class="mx-auto">{{ "DELIVER" | translate}}</label>
                                            </button>
                                            <button *ngIf="webOrders" class="btn btn-primary w-100 d-flex"
                                                (click)="openTransaction(activity, 'activity')">
                                                <label class="mx-auto"> {{ "OPEN_ACTIVITY" | translate}}</label>
                                            </button>
                                        </div>
                                    </div>

                                    <div class="row my-5">
                                        <div class="col">
                                            <div class="form-group w-100">
                                                <input type="text" name="activityName"
                                                    [(ngModel)]="activity.sProductName"
                                                    class="form-control form-control-solid">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">

                                        <div class="col-6">
                                            <div class="row mb-6">
                                                <label class="col-lg-4 col-form-label fw-bold fs-6">{{ "INTAKE_DATE" |
                                                    translate}}</label>
                                                <div class="col-lg-8">
                                                    <div class="row">
                                                        <div class="col-lg-8 fv-row">
                                                            <input type="date"
                                                                class="form-control form-control form-control-solid"
                                                                name="dCreatedDate"
                                                                [ngModel]="activity.dCreatedDate | date:'yyyy-MM-dd'"
                                                                (ngModelChange)="activity.dCreatedDate = $event"
                                                                readonly />

                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row mb-6">
                                                <label class="col-lg-4 col-form-label fw-bold fs-6">{{"LOCATION" |
                                                    translate}}</label>
                                                <div class="col-lg-8">
                                                    <div class="row">
                                                        <div class="col-lg-8 fv-row">
                                                            <input type="text"
                                                                class="form-control form-control-lg form-control-solid mb-3 mb-lg-0 w-100"
                                                                [(ngModel)]="oLocationName" placeholder="" readonly />
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <!-- <div class="row mb-6">
                                <label class="col-lg-4 col-form-label fw-bold fs-6">{{
                                    "ESTIMATED_DATE_READY" | translate}}</label>
                                <div class="col-lg-8">
                                    <div class="row">
                                        <div class="col-lg-8 fv-row">

                                            <input type="date"
                                                class="form-control form-control form-control-solid"
                                                name="dEstimatedDate"
                                                [ngModel]="activity.dEstimatedDate | date:'yyyy-MM-dd'"
                                                (ngModelChange)="activity.dEstimatedDate = $event" />
                                         
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row mb-6">
                                <label class="col-lg-4 col-form-label fw-bold fs-6">{{ "CONTACT_WHEN_READY"
                                    | translate}}</label>
                                <div class="col-lg-8">
                                    <div class="row">
                                        <div class="col-lg-8 fv-row">
                                            {{ "INTAKE_DATE" | translate}}
                                        </div>
                                    </div>
                                </div>
                            </div> -->
                                            <div class="row mb-6">
                                                <label class="col-lg-4 col-form-label fw-bold fs-6"> {{
                                                    "ESTIMATED_PRICE_UPON_INGESTION" | translate}}</label>
                                                <div class="col-lg-8">
                                                    <div class="row">
                                                        <div class="col-lg-8 fv-row">
                                                            <input type="number"
                                                                class="form-control form-control-lg form-control-solid mb-3 mb-lg-0 w-100"
                                                                [(ngModel)]="activity.nPriceIncVat" placeholder="">
                                                            <p *ngIf="activity?.oType?.bDiscount">Discount price
                                                                {{activity.nPriceIncVat - activity.nTotalAmount |
                                                                currency:tillService.currency }} </p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row mb-6">
                                                <label class="col-lg-4 col-form-label fw-bold fs-6">
                                                    {{"TO_BE_PAID(EXCL_FEES)" | translate}}</label>
                                                <div class="col-lg-8">
                                                    <div class="row">
                                                        <div class="col-lg-8 fv-row">
                                                            <input type="number"
                                                                class="form-control form-control-lg form-control-solid mb-3 mb-lg-0 w-100"
                                                                [(ngModel)]="activity.nPriceIncVat" placeholder="">
                                                            <p *ngIf="activity?.oType?.bDiscount">Discount price
                                                                {{activity.nPriceIncVat - activity.nTotalAmount |
                                                                currency:tillService.currency }} </p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>




                                            <div class="table-responsive">
                                                <table
                                                    class="table align-middle table-row-dashed fs-6 gy-5 dataTable no-footer">
                                                    <thead>
                                                        <tr
                                                            class="text-start text-gray-400 fw-bolder fs-7 text-uppercase gs-0">
                                                            <th>{{ "RECEIPT_NUMBER" | translate}}</th>
                                                            <th>{{ "CREATED_DATE" | translate}}</th>
                                                            <th>{{ "AMOUNT" |translate}}</th>
                                                            <ng-container *ngIf="from != 'transaction-details'">
                                                                <th>{{ 'ACTION' | translate }}</th>
                                                            </ng-container>
                                                        </tr>
                                                    </thead>
                                                    <tbody class="fw-bold text-gray-600">
                                                        <tr *ngFor='let receipt of activity.receipts'>
                                                            <td>{{receipt.sTransactionNumber}}</td>
                                                            <td>{{receipt.dCreatedDate | date: 'medium'}}</td>
                                                            <td>{{receipt.nPaymentAmount | currency:
                                                                tillService.currency}}</td>
                                                            <ng-container *ngIf="from != 'transaction-details'">
                                                                <td>
                                                                    <div class="d-flex align-items-center">
                                                                        <button class="btn btn-primary"
                                                                            (click)="showTransaction(receipt, $event)">
                                                                            {{ 'VIEW' | translate }}
                                                                        </button>
                                                                        <div *ngIf="receipt.bFetchingTransaction"
                                                                            class="spinner-border mx-2"></div>
                                                                    </div>
                                                                </td>
                                                            </ng-container>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                        <!-- <div class="col-3">
                            <div *ngIf="!activity?.aImage?.length">
                                {{"NO_IMAGES" | translate}}
                            </div>
                            <div class="d-flex">
                                <div class="image-input p-1 d-flex"
                                    *ngFor="let image of activity.aImage; let i = index"
                                    data-kt-image-input="true"
                                    style="background-image: url('assets/media/svg/avatars/blank.svg')">
                                    <div class="image-input-wrapper w-100px h-100px"
                                        style="background-image: url(assets/media/avatars/300-1.jpg)">
                                        <img src={{image}} width="100px" height="100px">
                                    </div>
                                    <div class="mt-2 ">
                                        <div data-kt-image-input-action="reorder" class="d-flex">
                                            <button
                                                class="btn btn-icon btn-circle btn-active-color-primary w-25px h-25px bg-body shadow"
                                                data-kt-image-input-action="remove" data-bs-toggle="tooltip"
                                                title="Remove image">
                                                <i class="bi bi-x fs-2"></i>
                                            </button>
                                        </div>

                                    </div>


                                </div>
                            </div>
                        </div> -->
                                        <div class="col-6">
                                            <!-- <div class="row mb-6">
                                <label class="col-lg-4 col-form-label fw-bold fs-6"> {{ "BRAND" |
                                    translate}}</label>
                                <div class="col-lg-8">
                                    <div class="row">
                                        <div class="col-lg-8 fv-row">
                                            <input type="text"
                                                class="form-control form-control-lg form-control-solid mb-3 mb-lg-0 w-100"
                                                [(ngModel)]="activity.iBrandId" placeholder="">
                                        </div>
                                    </div>
                                </div>
                            </div> -->
                                            <!-- <div class="row mb-6">
                                <label class="col-lg-4 col-form-label fw-bold fs-6">{{ "REPAIR_NUMBER"
                                    |translate}}</label>
                                <div class="col-lg-8">
                                    <div class="row">
                                        <div class="col-lg-8 fv-row">
                                            <input type="text"
                                                class="form-control form-control-lg form-control-solid mb-3 mb-lg-0 w-100"
                                                [(ngModel)]="activity.sBagNumber" placeholder="">
                                        </div>
                                    </div>
                                </div>
                            </div> -->
                                            <div class="row mb-6">
                                                <label class="col-lg-4 col-form-label fw-bold fs-6">{{
                                                    "COST_INCURRED(EXCL_VAT)" | translate}}</label>
                                                <div class="col-lg-8">
                                                    <div class="row">
                                                        <div class="col-lg-8 fv-row">
                                                            <input type="number"
                                                                class="form-control form-control-lg form-control-solid mb-3 mb-lg-0 w-100"
                                                                [(ngModel)]="activity.nPriceIncVat" placeholder="">
                                                            <p *ngIf="activity?.oType?.bDiscount">Discount price
                                                                {{activity.nPriceIncVat - activity.nTotalAmount |
                                                                currency:tillService.currency }} </p>
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- <div class="row mb-6">
                                <label class="col-lg-4 col-form-label fw-bold fs-6">{{ "PRODUCT_CATEGORY" |
                                    translate}}</label>
                                <div class="col-lg-8">
                                    <div class="row">
                                        <div class="col-lg-8 fv-row">
                                            <input type="text"
                                                class="form-control form-control-lg form-control-solid mb-3 mb-lg-0 w-100"
                                                [(ngModel)]="activity.iArticleGroupId" placeholder="">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row mb-6">
                                <label class="col-lg-4 col-form-label fw-bold fs-6">{{ "PRODUCT_MATERIAL" |
                                    translate}}</label>
                                <div class="col-lg-8">
                                    <div class="row">
                                        <div class="col-lg-8 fv-row">
                                            <input type="text"
                                                class="form-control form-control-lg form-control-solid mb-3 mb-lg-0 w-100"
                                                [(ngModel)]="activity.iArticleGroupId" placeholder="">
                                        </div>
                                    </div>
                                </div>
                            </div> -->
                                                <!-- <div class="row mb-6">
                                <label class="col-lg-4 col-form-label fw-bold fs-6"> {{ "SUPPLIER" |
                                    translate}}</label>
                                <div class="col-lg-8">
                                    <div class="row">
                                        <div class="col-lg-8 fv-row">
                                            <input type="text"
                                                class="form-control form-control-lg form-control-solid mb-3 mb-lg-0 w-100"
                                                [(ngModel)]="activity.iSupplierId" placeholder="">
                                        </div>
                                    </div>
                                </div>
                            </div> -->


                                                <!-- <div class="row">

                                <div class="fw-bold fs-6 my-2">
                                    {{ "I_REPAIR_THIS_MYSELF" | translate}}
                                </div>
                                <div class="col">

                                    <div class="row mb-6">
                                        <label class="col-lg-4 col-form-label fw-bold fs-6">{{ "REPAIRER" |
                                            translate}}</label>
                                        <div class="col-lg-8">
                                            <div class="row ">
                                                <div class="col-lg-8 fv-row">
                                                    <ng-select *ngIf="!employee" [(ngModel)]="employee"
                                                        (search)="searchEmployees($event.term)"
                                                        class="form-control form-control-solid p-0 w-100 custom"
                                                        placeholder="Search employee" [minTermLength]="2"
                                                        [clearable]="false"
                                                        [isOpen]="filteredEmployees.length > 0"
                                                        (change)="onEmployeeChange($event)">
                                                        <ng-option *ngFor="let option of filteredEmployees"
                                                            [value]="option">
                                                            {{option.sName ||
                                                            'Unknown'}}</ng-option>
                                                    </ng-select>

                                                    <div class="chip d-flex" *ngIf="employee">
                                                        {{employee}}
                                                        <div (click)="employee=null">
                                                            &nbsp;<i
                                                                class="close fas fa-times cursor-pointer"></i>
                                                        </div>
                                                    </div>

                                                </div>
                                            </div>
                                            <div class="row my-4">
                                                <div class="col-md-8 text-center">
                                                    <label>{{ "OR" | translate}}</label>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-lg-8 fv-row">
                                                    <ng-select *ngIf="!supplier" [(ngModel)]="supplier"
                                                        (search)="searchSuppliers($event.term)"
                                                        class="form-control form-control-solid p-0 w-100 custom"
                                                        placeholder="Search repairer" [minTermLength]="2"
                                                        [clearable]="false"
                                                        [isOpen]="supplierOptions.length > 0"
                                                        (change)="onSupplierChange($event)">
                                                        <ng-option *ngFor="let option of supplierOptions"
                                                            [value]="option">
                                                            {{option.sName ||
                                                            'Unknown'}}</ng-option>
                                                    </ng-select>
                                                    <div class="chip d-flex" *ngIf="supplier">
                                                        {{supplier}}
                                                        <div (click)="supplier=null">
                                                            &nbsp;<i
                                                                class="close fas fa-times cursor-pointer"></i>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="row mb-6">
                                        <label class="col-lg-4 col-form-label fw-bold fs-6"><label
                                                for="brand">{{ "BRAND" | translate}}</label></label>
                                        <div class="col-lg-8">
                                            <div class="row">
                                                <div class="col-lg-8 fv-row">
                                                    <ng-select *ngIf="!brand" [(ngModel)]="brand"
                                                        (search)="searchBrands($event.term)"
                                                        class="form-control form-control-solid p-0 w-100 custom"
                                                        placeholder="Search brand" [minTermLength]="2"
                                                        [clearable]="false"
                                                        [isOpen]="filteredBrands.length > 0"
                                                        (change)="onBrandChange($event)">
                                                        <ng-option *ngFor="let option of filteredBrands"
                                                            [value]="option">
                                                            {{option.sName ||
                                                            'Unknown'}}</ng-option>
                                                    </ng-select>
                                                    <div class="chip d-flex" *ngIf="brand">
                                                        {{brand}}
                                                        <div (click)="brand=null">
                                                            &nbsp;<i
                                                                class="close fas fa-times cursor-pointer"></i>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>



                                </div>
                            </div> -->
                                            </div>
                                        </div>
                                        <!-- 
                    <div class="row">
                        <div class="col-6">
                            <div class="row mb-6">
                                <label class="col-lg-12 col-form-label fw-bold fs-6">{{
                                    "REMARK_FOR_SERVICE_PARTNERS" | translate}}</label>
                                <div class="col-lg-12">
                                    <div class="row">
                                        <div class="col-lg-12 fv-row">
                                            <textarea
                                                class="form-control form-control-lg form-control-solid mb-3 mb-lg-0 w-100"
                                                placeholder="{{ 'REMARK_FOR_SERVICE_PARTNERS' | translate}}"
                                                lines="10"
                                                [(ngModel)]="activity.sCommentVisibleServicePartner"></textarea>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-6">
                            <div class="row mb-6">
                                <label class="col-lg-12 col-form-label fw-bold fs-6">{{
                                    "REMARK_FOR_COLLEAGUES" |
                                    translate}}</label>
                                <div class="col-lg-12">
                                    <div class="row">
                                        <div class="col-lg-12 fv-row">
                                            <textarea
                                                class="form-control form-control-lg form-control-solid mb-3 mb-lg-0 w-100"
                                                placeholder="{{ 'REMARK_FOR_SERVICE_PARTNERS' | translate}}"
                                                lines="10"
                                                [(ngModel)]="activity.sCommentVisibleCollegues"></textarea>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div> -->
                                        <div class="row">
                                            <div class="col-3">
                                                <button class="btn btn-primary" (click)="submit(activity._id , index)"
                                                    type="submit"> {{ "SUBMIT" | translate}}</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="accordion-collapse collapse" *ngIf="activity.oType.eKind == 'gold-purchase'"
                                data-bs-parent="accordion" [ngClass]="{'show': activity.collapsedBtn }">
                                <div class="accordion-body">
                                    <div class="row">
                                        <div class="col-4">
                                            <div class="form-group mb-6">
                                                <label class="form-control-label mb-3">{{ "NAME" | translate}}</label>
                                                <input class="form-control form-control-solid mb-3 mb-lg-0" type="text"
                                                    name="activityName" [(ngModel)]="activity.sProductName">
                                            </div>
                                            <div class="form-group mb-6">
                                                <label class="form-control-label mb-3">{{ "DESCRIPTION" |
                                                    translate}}</label>
                                                <textarea class="form-control form-control-solid" name="description"
                                                    placeholder="{{ 'DESCRIPTION' | translate}}" lines="10"
                                                    [(ngModel)]="activity.sDescription"></textarea>
                                            </div>

                                        </div>
                                        <div class="col-5">

                                            <div class="form-group mb-6">
                                                <label class="form-control-label mb-3">{{ "STATUS" | translate}}
                                                </label>
                                                <select name="status" id="status"
                                                    class="form-control form-control-solid"
                                                    [(ngModel)]="activity.eActivityItemStatus">
                                                    <option *ngFor="let type of repairStatus" [value]="type.value">{{type.key | translate}}
                                                    </option>
                                                </select>
                                            </div>
                                            <div>
                                                {{"INFORM_CUSTOMER_THAT_PRODUCT_CAN_BE_PICKED_UP" | translate}}
                                            </div>
                                            <div class="border p-3 mb-5">
                                                <div class="border p-1 my-3 px-4">
                                                    {{ "TO_BE_PAID(EXCL_FEES)" | translate}}
                                                </div>
                                                <div class="row">
                                                    <div class="col-8">
                                                        <input class="form-control form-control-solid w-100" type="text"
                                                            [(ngModel)]="activity.nTotalAmount">
                                                    </div>
                                                    <div class="col-4">
                                                        <button class="btn btn-primary">{{ "MAIL_CUSTOMER" |
                                                            translate}}</button>
                                                    </div>
                                                </div>
                                                <div class="row mt-2">
                                                    <div class="col-6">
                                                        {{"ALREADY_PAID" | translate}}: {{activity.nPaidAmount |
                                                        currency:
                                                        tillService.currency}}
                                                    </div>
                                                    <div class="col-6">
                                                        {{"STILL_TO_PAY" | translate}}: {{(activity.nTotalAmount -
                                                        activity.nPaidAmount)
                                                        |
                                                        currency:
                                                        tillService.currency}}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-3 my-3">
                                            <div class="btn-group me-4 w-100 my-3">
                                                <span class="btn btn-primary fs-bold"
                                                    (click)="downloadCustomerReceipt(index)">
                                                    <fa-icon class="group-icon" [icon]="faUser"></fa-icon>
                                                    <span class="indicator-label ">{{ "CUSTOMER_RECEIPT" | translate
                                                        }}</span>
                                                </span>

                                                <span class="btn btn-primary btn-icon fs-bold" role="button">
                                                    <div class="btn btn-icon" data-kt-menu-trigger="click"
                                                        data-kt-menu-attach="parent" data-kt-menu-placement="bottom-end"
                                                        data-kt-menu-flip="bottom">
                                                        <span class="svg-icon svg-icon-2 m-0">
                                                            <svg xmlns="http://www.w3.org/2000/svg" width="24"
                                                                height="24" viewBox="0 0 24 24" fill="none">
                                                                <path
                                                                    d="M11.4343 12.7344L7.25 8.55005C6.83579 8.13583 6.16421 8.13584 5.75 8.55005C5.33579 8.96426 5.33579 9.63583 5.75 10.05L11.2929 15.5929C11.6834 15.9835 12.3166 15.9835 12.7071 15.5929L18.25 10.05C18.6642 9.63584 18.6642 8.96426 18.25 8.55005C17.8358 8.13584 17.1642 8.13584 16.75 8.55005L12.5657 12.7344C12.2533 13.0468 11.7467 13.0468 11.4343 12.7344Z"
                                                                    fill="black"></path>
                                                            </svg>
                                                        </span>
                                                    </div>
                                                    <div class="menu menu-sub menu-sub-dropdown menu-column menu-rounded menu-gray-600 menu-state-bg-light-primary fw-bold fs-7 w-200px py-4"
                                                        data-kt-menu="true">
                                                        <div class="menu-item px-3 text-center">
                                                            <div class="menu-link px-3">tMenu</div>
                                                        </div>
                                                        <div class="menu-item px-3 text-center">
                                                            <div class="menu-link px-3">tMenu</div>
                                                        </div>
                                                    </div>
                                                </span>
                                            </div>
                                            <div class="btn-group me-4 w-100 my-3">
                                                <span class="btn btn-primary fs-bold"
                                                    (click)="downloadCustomerReceipt(index)">
                                                    <fa-icon class="group-icon" [icon]="faPrint"></fa-icon>
                                                    <span class="indicator-label">{{"CUSTOMER_RECEIPT_PRINT" | translate}}</span>
                                                </span>

                                                <span class="btn btn-primary btn-icon fs-bold printer-button-span"
                                                    role="button">
                                                    <div class="btn btn-icon" data-kt-menu-trigger="click"
                                                        data-kt-menu-attach="parent"
                                                        data-kt-menu-placement="bottom-start"
                                                        data-kt-menu-flip="bottom">
                                                        <span class="svg-icon svg-icon-2 m-0">
                                                            <svg xmlns="http://www.w3.org/2000/svg" width="24"
                                                                height="24" viewBox="0 0 24 24" fill="none">
                                                                <path
                                                                    d="M11.4343 12.7344L7.25 8.55005C6.83579 8.13583 6.16421 8.13584 5.75 8.55005C5.33579 8.96426 5.33579 9.63583 5.75 10.05L11.2929 15.5929C11.6834 15.9835 12.3166 15.9835 12.7071 15.5929L18.25 10.05C18.6642 9.63584 18.6642 8.96426 18.25 8.55005C17.8358 8.13584 17.1642 8.13584 16.75 8.55005L12.5657 12.7344C12.2533 13.0468 11.7467 13.0468 11.4343 12.7344Z"
                                                                    fill="black"></path>
                                                            </svg>
                                                        </span>
                                                    </div>
                                                    <div class="menu menu-sub menu-sub-dropdown menu-column menu-rounded menu-gray-600 menu-state-bg-light-primary fw-bold fs-7 w-200px py-4"
                                                        data-kt-menu="true">
                                                        <div class="menu-item px-3 text-center">
                                                            <div class="menu-link px-3">tMenu</div>
                                                        </div>
                                                    </div>
                                                </span>
                                            </div>
                                            <div class="btn-group me-4 w-100 my-3">
                                                <span class="btn btn-primary fs-bold">
                                                    <fa-icon class="group-icon" [icon]="faReceipt"></fa-icon>
                                                    <span class="indicator-label">{{ "RECEIPT_PARTNER" |
                                                        translate}}</span>
                                                </span>
                                                <span class="btn btn-primary btn-icon fs-bold" role="button">
                                                    <div class="btn btn-icon" data-kt-menu-trigger="click"
                                                        data-kt-menu-attach="parent"
                                                        data-kt-menu-placement="bottom-start"
                                                        data-kt-menu-flip="bottom">
                                                        <span class="svg-icon svg-icon-2 m-0">
                                                            <svg xmlns="http://www.w3.org/2000/svg" width="24"
                                                                height="24" viewBox="0 0 24 24" fill="none">
                                                                <path
                                                                    d="M11.4343 12.7344L7.25 8.55005C6.83579 8.13583 6.16421 8.13584 5.75 8.55005C5.33579 8.96426 5.33579 9.63583 5.75 10.05L11.2929 15.5929C11.6834 15.9835 12.3166 15.9835 12.7071 15.5929L18.25 10.05C18.6642 9.63584 18.6642 8.96426 18.25 8.55005C17.8358 8.13584 17.1642 8.13584 16.75 8.55005L12.5657 12.7344C12.2533 13.0468 11.7467 13.0468 11.4343 12.7344Z"
                                                                    fill="black"></path>
                                                            </svg>
                                                        </span>
                                                    </div>
                                                    <div class="menu menu-sub menu-sub-dropdown menu-column menu-rounded menu-gray-600 menu-state-bg-light-primary fw-bold fs-7 w-200px py-4"
                                                        data-kt-menu="true">
                                                        <div class="menu-item px-3 text-center">
                                                            <div class="menu-link px-3">tMenu</div>
                                                        </div>
                                                    </div>
                                                </span>
                                            </div>
                                            <div class="btn-group me-4 w-100 my-3">
                                                <span class="btn btn-primary fs-bold">
                                                    <span>
                                                        <fa-icon class="group-icon" [icon]="faReceipt"></fa-icon>
                                                    </span>
                                                    <span class="indicator-label">{{ "RECEIPT_FOR_BOTH" |
                                                        translate}}</span>
                                                </span>
                                                <span class="btn btn-primary btn-icon fs-bold" role="button">
                                                    <div class="btn btn-icon" data-kt-menu-trigger="click"
                                                        data-kt-menu-attach="parent"
                                                        data-kt-menu-placement="bottom-start"
                                                        data-kt-menu-flip="bottom">
                                                        <span class="svg-icon svg-icon-2 m-0">
                                                            <svg xmlns="http://www.w3.org/2000/svg" width="24"
                                                                height="24" viewBox="0 0 24 24" fill="none">
                                                                <path
                                                                    d="M11.4343 12.7344L7.25 8.55005C6.83579 8.13583 6.16421 8.13584 5.75 8.55005C5.33579 8.96426 5.33579 9.63583 5.75 10.05L11.2929 15.5929C11.6834 15.9835 12.3166 15.9835 12.7071 15.5929L18.25 10.05C18.6642 9.63584 18.6642 8.96426 18.25 8.55005C17.8358 8.13584 17.1642 8.13584 16.75 8.55005L12.5657 12.7344C12.2533 13.0468 11.7467 13.0468 11.4343 12.7344Z"
                                                                    fill="black"></path>
                                                            </svg>
                                                        </span>
                                                    </div>
                                                    <div class="menu menu-sub menu-sub-dropdown menu-column menu-rounded menu-gray-600 menu-state-bg-light-primary fw-bold fs-7 w-200px py-4"
                                                        data-kt-menu="true">
                                                        <div class="menu-item px-3 text-center">
                                                            <div class="menu-link px-3">tMenu</div>
                                                        </div>
                                                    </div>
                                                </span>
                                            </div>
                                            <div class="btn-group me-4 w-100 my-3">
                                                <span class="btn btn-primary fs-bold">
                                                    <fa-icon class="group-icon" [icon]="faEnvelope"></fa-icon>
                                                    <span class="indicator-label">{{ "MAIL" | translate}}</span>
                                                </span>
                                            </div>
                                            <div class="btn-group me-4 w-100 my-3">
                                                <span class="btn btn-primary fs-bold"
                                                    (click)="loadCashRegister = true; openTransaction(activity, 'activity')">
                                                    <fa-icon class="group-icon" [icon]="faEuro"></fa-icon>
                                                    <span class="indicator-label">{{ "CHECKOUT" | translate}}</span>
                                                </span>
                                            </div>
                                        </div>
                                    </div>
                                    <div *ngIf="activity.eRepairStatus === 'completed'"
                                        class="col-md-12 card-body d-flex flex-wrap py-5 border mt-5 mb-5 row">
                                        <div class="col-md-8">
                                            <div class="">
                                                <span>{{ "SHIPPING_METHOD" | translate }} : </span>
                                                <label class="form-control form-control-solid-solid">{{
                                                    "STANDARD_SHIPPING"
                                                    | translate}}</label>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-6">
                                                    <label>{{ "CARRIER" | translate}}</label>
                                                </div>
                                                <div class="col-md-6">
                                                    <select name="career" id="career"
                                                        class="form-select form-select-solid">
                                                        <option>PostNL</option>
                                                    </select>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <input type="text" class="form-control form-control-solid"
                                                    placeholder="www.trackandtracelink.com">
                                            </div>
                                            <div class="row">
                                                <label>{{ "PLACE_TRACKING_CODE" | translate}}</label>
                                            </div>
                                            <div class="row">
                                                <label>{{ "OPEN_TRACKING_LINK" | translate}}</label>
                                            </div>
                                        </div>
                                        <div class="col-md-4 gap-5">
                                            <button class="btn btn-primary w-100 d-flex">
                                                <label class="mx-auto">{{ "SEND_TO_CUSTOMER" | translate}}</label>
                                            </button>
                                            <button class="btn btn-secondary w-100 d-flex">
                                                <label class="mx-auto"> {{ "READY_TO_PICKUP" | translate}}</label>
                                            </button>
                                            <button class="btn btn-secondary w-100 d-flex">
                                                <label class="mx-auto">{{ "DELIVER" | translate}}</label>
                                            </button>
                                            <button *ngIf="webOrders" class="btn btn-primary w-100 d-flex"
                                                (click)="openTransaction(activity, 'activity')">
                                                <label class="mx-auto"> {{ "OPEN_ACTIVITY" | translate}}</label>
                                            </button>
                                        </div>
                                    </div>

                                    <div class="row my-5">
                                        <div class="col">
                                            <div class="form-group w-100">
                                                <input type="text" name="activityName"
                                                    [(ngModel)]="activity.sProductName"
                                                    class="form-control form-control-solid">
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">

                                        <div class="col-6">
                                            <div class="row mb-6">
                                                <label class="col-lg-4 col-form-label fw-bold fs-6">{{ "INTAKE_DATE" |
                                                    translate}}</label>
                                                <div class="col-lg-8">
                                                    <div class="row">
                                                        <div class="col-lg-8 fv-row">
                                                            <input type="date"
                                                                class="form-control form-control form-control-solid"
                                                                name="dCreatedDate"
                                                                [ngModel]="activity.dCreatedDate | date:'yyyy-MM-dd'"
                                                                (ngModelChange)="activity.dCreatedDate = $event"
                                                                readonly />

                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row mb-6">
                                                <label class="col-lg-4 col-form-label fw-bold fs-6">{{"LOCATION" |
                                                    translate}}</label>
                                                <div class="col-lg-8">
                                                    <div class="row">
                                                        <div class="col-lg-8 fv-row">
                                                            <input type="text"
                                                                class="form-control form-control-lg form-control-solid mb-3 mb-lg-0 w-100"
                                                                [(ngModel)]="oLocationName" placeholder="" readonly />
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <!-- <div class="row mb-6">
                                <label class="col-lg-4 col-form-label fw-bold fs-6">{{
                                    "ESTIMATED_DATE_READY" | translate}}</label>
                                <div class="col-lg-8">
                                    <div class="row">
                                        <div class="col-lg-8 fv-row">

                                            <input type="date"
                                                class="form-control form-control form-control-solid"
                                                name="dEstimatedDate"
                                                [ngModel]="activity.dEstimatedDate | date:'yyyy-MM-dd'"
                                                (ngModelChange)="activity.dEstimatedDate = $event" />
                                       
                                        </div>
                                    </div>
                                </div>
                            </div> -->
                                            <!-- <div class="row mb-6">
                                <label class="col-lg-4 col-form-label fw-bold fs-6">{{ "CONTACT_WHEN_READY"
                                    | translate}}</label>
                                <div class="col-lg-8">
                                    <div class="row">
                                        <div class="col-lg-8 fv-row">
                                            {{ "INTAKE_DATE" | translate}}
                                        </div>
                                    </div>
                                </div>
                            </div> -->
                                            <div class="row mb-6">
                                                <label class="col-lg-4 col-form-label fw-bold fs-6"> {{
                                                    "ESTIMATED_PRICE_UPON_INGESTION" | translate}}</label>
                                                <div class="col-lg-8">
                                                    <div class="row">
                                                        <div class="col-lg-8 fv-row">
                                                            <input type="text"
                                                                class="form-control form-control-lg form-control-solid mb-3 mb-lg-0 w-100"
                                                                [(ngModel)]="activity.nPriceIncVat" placeholder="">
                                                            <p *ngIf="activity?.oType?.bDiscount">Discount price
                                                                {{activity.nPriceIncVat - activity.nTotalAmount |
                                                                currency:tillService.currency }} </p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row mb-6">
                                                <label class="col-lg-4 col-form-label fw-bold fs-6">
                                                    {{"TO_BE_PAID(EXCL_FEES)" | translate}}</label>
                                                <div class="col-lg-8">
                                                    <div class="row">
                                                        <div class="col-lg-8 fv-row">
                                                            <input type="text"
                                                                class="form-control form-control-lg form-control-solid mb-3 mb-lg-0 w-100"
                                                                [(ngModel)]="activity.nPriceIncVat" placeholder="">
                                                            <p *ngIf="activity?.oType?.bDiscount">Discount price
                                                                {{activity.nPriceIncVat - activity.nTotalAmount |
                                                                currency:tillService.currency }} </p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>




                                            <div class="table-responsive">
                                                <table
                                                    class="table align-middle table-row-dashed fs-6 gy-5 dataTable no-footer">
                                                    <thead>
                                                        <tr
                                                            class="text-start text-gray-400 fw-bolder fs-7 text-uppercase gs-0">
                                                            <th>{{ "RECEIPT_NUMBER" | translate}}</th>
                                                            <th>{{ "CREATED_DATE" | translate}}</th>
                                                            <th>{{ "AMOUNT" |translate}}</th>
                                                            <ng-container *ngIf="from != 'transaction-details'">
                                                                <th>{{ 'ACTION' | translate }}</th>
                                                            </ng-container>
                                                        </tr>
                                                    </thead>
                                                    <tbody class="fw-bold text-gray-600">
                                                        <tr *ngFor='let receipt of activity.receipts'>
                                                            <td>{{receipt.sTransactionNumber}}</td>
                                                            <td>{{receipt.dCreatedDate | date: 'medium'}}</td>
                                                            <td>{{receipt.nPaymentAmount | currency:
                                                                tillService.currency}}</td>
                                                            <ng-container *ngIf="from != 'transaction-details'">
                                                                <td>
                                                                    <div class="d-flex align-items-center">
                                                                        <button class="btn btn-primary"
                                                                            (click)="showTransaction(receipt, $event)">
                                                                            {{ 'VIEW' | translate }}
                                                                        </button>
                                                                        <div *ngIf="receipt.bFetchingTransaction"
                                                                            class="spinner-border mx-2"></div>
                                                                    </div>
                                                                </td>
                                                            </ng-container>
                                                        </tr>
                                                    </tbody>
                                                </table>
                                            </div>
                                        </div>
                                        <!-- <div class="col-3">
                            <div *ngIf="!activity?.aImage?.length">
                                {{"NO_IMAGES" | translate}}
                            </div>
                            <div class="d-flex">
                                <div class="image-input p-1 d-flex"
                                    *ngFor="let image of activity.aImage; let i = index"
                                    data-kt-image-input="true"
                                    style="background-image: url('assets/media/svg/avatars/blank.svg')">
                                    <div class="image-input-wrapper w-100px h-100px"
                                        style="background-image: url(assets/media/avatars/300-1.jpg)">
                                        <img src={{image}} width="100px" height="100px">
                                    </div>
                                    <div class="mt-2 ">
                                        <div data-kt-image-input-action="reorder" class="d-flex">
                                            <button
                                                class="btn btn-icon btn-circle btn-active-color-primary w-25px h-25px bg-body shadow"
                                                data-kt-image-input-action="remove" data-bs-toggle="tooltip"
                                                title="Remove image">
                                                <i class="bi bi-x fs-2"></i>
                                            </button>
                                        </div>

                                    </div>


                                </div>
                            </div>
                        </div> -->
                                        <div class="col-6">
                                            <!-- <div class="row mb-6">
                                <label class="col-lg-4 col-form-label fw-bold fs-6"> {{ "BRAND" |
                                    translate}}</label>
                                <div class="col-lg-8">
                                    <div class="row">
                                        <div class="col-lg-8 fv-row">
                                            <input type="text"
                                                class="form-control form-control-lg form-control-solid mb-3 mb-lg-0 w-100"
                                                [(ngModel)]="activity.iBrandId" placeholder="">
                                        </div>
                                    </div>
                                </div>
                            </div> -->
                                            <div class="row mb-6">
                                                <label class="col-lg-4 col-form-label fw-bold fs-6">{{ "REPAIR_NUMBER"
                                                    |translate}}</label>
                                                <div class="col-lg-8">
                                                    <div class="row">
                                                        <div class="col-lg-8 fv-row">
                                                            <input type="text"
                                                                class="form-control form-control-lg form-control-solid mb-3 mb-lg-0 w-100"
                                                                [(ngModel)]="activity.sBagNumber" placeholder="">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row mb-6">
                                                <label class="col-lg-4 col-form-label fw-bold fs-6">{{
                                                    "COST_INCURRED(EXCL_VAT)" | translate}}</label>
                                                <div class="col-lg-8">
                                                    <div class="row">
                                                        <div class="col-lg-8 fv-row">
                                                            <input type="text"
                                                                class="form-control form-control-lg form-control-solid mb-3 mb-lg-0 w-100"
                                                                [(ngModel)]="activity.nPriceIncVat" placeholder="">
                                                            <p *ngIf="activity?.oType?.bDiscount">Discount price
                                                                {{activity.nPriceIncVat - activity.nTotalAmount |
                                                                currency:tillService.currency }} </p>
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- <div class="row mb-6">
                                <label class="col-lg-4 col-form-label fw-bold fs-6">{{ "PRODUCT_CATEGORY" |
                                    translate}}</label>
                                <div class="col-lg-8">
                                    <div class="row">
                                        <div class="col-lg-8 fv-row">
                                            <input type="text"
                                                class="form-control form-control-lg form-control-solid mb-3 mb-lg-0 w-100"
                                                [(ngModel)]="activity.iArticleGroupId" placeholder="">
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row mb-6">
                                <label class="col-lg-4 col-form-label fw-bold fs-6">{{ "PRODUCT_MATERIAL" |
                                    translate}}</label>
                                <div class="col-lg-8">
                                    <div class="row">
                                        <div class="col-lg-8 fv-row">
                                            <input type="text"
                                                class="form-control form-control-lg form-control-solid mb-3 mb-lg-0 w-100"
                                                [(ngModel)]="activity.iArticleGroupId" placeholder="">
                                        </div>
                                    </div>
                                </div>
                            </div> -->
                                                <!-- <div class="row mb-6">
                                <label class="col-lg-4 col-form-label fw-bold fs-6"> {{ "SUPPLIER" |
                                    translate}}</label>
                                <div class="col-lg-8">
                                    <div class="row">
                                        <div class="col-lg-8 fv-row">
                                            <input type="text"
                                                class="form-control form-control-lg form-control-solid mb-3 mb-lg-0 w-100"
                                                [(ngModel)]="activity.iSupplierId" placeholder="">
                                        </div>
                                    </div>
                                </div>
                            </div> -->


                                                <div class="row">

                                                    <div class="fw-bold fs-6 my-2">
                                                        {{ "I_REPAIR_THIS_MYSELF" | translate}}
                                                    </div>
                                                    <div class="col">

                                                        <div class="row mb-6">
                                                            <label class="col-lg-4 col-form-label fw-bold fs-6">{{
                                                                "REPAIRER" |
                                                                translate}}</label>
                                                            <div class="col-lg-8">
                                                                <div class="row ">
                                                                    <div class="col-lg-8 fv-row">
                                                                        <ng-select *ngIf="!activity.iAssigneeId"
                                                                            [(ngModel)]="activity.iAssigneeId"
                                                                            (search)="searchEmployees($event.term)"
                                                                            class="form-control form-control-solid p-0 w-100 custom"
                                                                            placeholder="{{'SEARCH_EMPLOYEE'| translate }}"
                                                                            [minTermLength]="2" [clearable]="false"
                                                                            [isOpen]="filteredEmployees.length > 0"
                                                                            (change)="onEmployeeChange($event , index)">
                                                                            <ng-option
                                                                                *ngFor="let option of filteredEmployees"
                                                                                [value]="option">
                                                                                {{option.sName ||
                                                                                'Unknown'}}</ng-option>
                                                                        </ng-select>

                                                                        <div class="chip d-flex"
                                                                            *ngIf="activity.iAssigneeId">
                                                                            {{activity.employeeName}}
                                                                            <div (click)="removeEmployeees(index)">
                                                                                &nbsp;<i
                                                                                    class="close fas fa-times cursor-pointer"></i>
                                                                            </div>
                                                                        </div>

                                                                    </div>
                                                                </div>
                                                                <div class="row my-4">
                                                                    <div class="col-md-8 text-center">
                                                                        <label>{{ "OR" | translate}}</label>
                                                                    </div>
                                                                </div>


                                                                <div class="row">
                                                                    <div class="col-lg-8 fv-row">
                                                                        <ng-select *ngIf="!activity.iBusinessPartnerId"
                                                                            [(ngModel)]="activity.iBusinessPartnerId"
                                                                            (search)="searchSuppliers($event.term)"
                                                                            class="form-control form-control-solid p-0 w-100 custom"
                                                                            placeholder="{{'SEARCH_REPAIRER' | translate }}"
                                                                            [minTermLength]="2" [clearable]="false"
                                                                            [isOpen]="supplierOptions.length > 0"
                                                                            (change)="onSupplierChange($event,index)">
                                                                            <ng-option
                                                                                *ngFor="let option of supplierOptions"
                                                                                [value]="option">
                                                                                {{option.sName ||
                                                                                'Unknown'}}</ng-option>
                                                                        </ng-select>
                                                                        <div class="chip d-flex"
                                                                            *ngIf="activity.iBusinessPartnerId">
                                                                            {{activity.sBusinessPartnerName}}
                                                                            <div (click)="removeSuppliers(index)">
                                                                                &nbsp;<i
                                                                                    class="close fas fa-times cursor-pointer"></i>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>

                                                        <div class="row mb-6">
                                                            <label class="col-lg-4 col-form-label fw-bold fs-6"><label
                                                                    for="brand">{{ "BRAND" | translate}}</label></label>
                                                            <div class="col-lg-8">
                                                                <div class="row">
                                                                    <div class="col-lg-8 fv-row">
                                                                        <ng-select *ngIf="!activity.iBusinessBrandId"
                                                                            [(ngModel)]="activity.iBusinessBrandId"
                                                                            (search)="searchBrands($event.term)"
                                                                            class="form-control form-control-solid p-0 w-100 custom"
                                                                            placeholder="{{'SEARCH_BRAND' | translate}}"
                                                                            [minTermLength]="2" [clearable]="false"
                                                                            [isOpen]="filteredBrands.length > 0"
                                                                            (change)="onBrandChange($event, index)">
                                                                            <ng-option
                                                                                *ngFor="let option of filteredBrands"
                                                                                [value]="option">
                                                                                {{option.sName ||
                                                                                'Unknown'}}</ng-option>
                                                                        </ng-select>
                                                                        <div class="chip d-flex"
                                                                            *ngIf="activity.iBusinessBrandId">
                                                                            {{activity.brandName}}
                                                                            <div (click)="removeBrands(index)">
                                                                                &nbsp;<i
                                                                                    class="close fas fa-times cursor-pointer"></i>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="row">
                                            <div class="col-6">
                                                <div class="row mb-6">
                                                    <label class="col-lg-12 col-form-label fw-bold fs-6">{{
                                                        "REMARK_FOR_SERVICE_PARTNERS" | translate}}</label>
                                                    <div class="col-lg-12">
                                                        <div class="row">
                                                            <div class="col-lg-12 fv-row">
                                                                <textarea
                                                                    class="form-control form-control-lg form-control-solid mb-3 mb-lg-0 w-100"
                                                                    placeholder="{{ 'REMARK_FOR_SERVICE_PARTNERS' | translate}}"
                                                                    lines="10"
                                                                    [(ngModel)]="activity.sCommentVisibleServicePartner"></textarea>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-6">
                                                <div class="row mb-6">
                                                    <label class="col-lg-12 col-form-label fw-bold fs-6">{{
                                                        "REMARK_FOR_COLLEAGUES" |
                                                        translate}}</label>
                                                    <div class="col-lg-12">
                                                        <div class="row">
                                                            <div class="col-lg-12 fv-row">
                                                                <textarea
                                                                    class="form-control form-control-lg form-control-solid mb-3 mb-lg-0 w-100"
                                                                    placeholder="{{ 'REMARK_FOR_SERVICE_PARTNERS' | translate}}"
                                                                    lines="10"
                                                                    [(ngModel)]="activity.sCommentVisibleCollegues"></textarea>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                        </div>
                                        <div class="row">
                                            <div class="col-3">
                                                <button class="btn btn-primary" (click)="submit(activity._id , index)"
                                                    type="submit"> {{ "SUBMIT" | translate}}</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="d-flex mt-100">
                        <h5 *ngIf='!activityItems.length && !loading' style="text-align: center">{{'NO_DATA_FOUND' |
                            translate }}
                        </h5>
                        <div *ngIf="loading" class="spinner-border mx-auto"></div>
                    </div>


                </div>
            </div>

        </div>


    </div>
